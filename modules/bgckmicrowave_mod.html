
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>bgckMicrowave_mod &#8212; MIDAS  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinxdoc.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="bgckOcean_mod" href="bgckocean_mod.html" />
    <link rel="prev" title="bgckCSR_mod" href="bgckcsr_mod.html" /> 
  </head><body>
  <div>
    <img src="../_static/MIDAS_header.png" alt="MIDAS" />
  </div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="bgckocean_mod.html" title="bgckOcean_mod"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="bgckcsr_mod.html" title="bgckCSR_mod"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">MIDAS  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">bgckMicrowave_mod</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="bgckcsr_mod.html"
                          title="previous chapter">bgckCSR_mod</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="bgckocean_mod.html"
                          title="next chapter">bgckOcean_mod</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/modules/bgckmicrowave_mod.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="bgckmicrowave-mod">
<h1>bgckMicrowave_mod<a class="headerlink" href="#bgckmicrowave-mod" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><p><a class="reference internal" href="bgckmicrowave_mod_src.html"><span class="doc">link to source code</span></a></p>
<p><strong>Dependency Diagrams:</strong></p>
<figure class="align-default" id="id7">
<a class="reference internal image-reference" href="bgckMicrowave_mod.svg"><img alt="bgckMicrowave_mod.svg" height="100px" src="bgckMicrowave_mod.svg" /></a>
<figcaption>
<p><span class="caption-text">Direct Dependency Diagram</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id8">
<a class="reference internal image-reference" href="bgckMicrowave_mod_rev.svg"><img alt="bgckMicrowave_mod_rev.svg" height="100px" src="bgckMicrowave_mod_rev.svg" /></a>
<figcaption>
<p><span class="caption-text">Reverse Dependency Diagram</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<span class="target" id="f/bgckmicrowave_mod"></span><p class="rubric">Description</p>
<p>MODULE bgckMicrowave_mod (prefix=’mwbg’ category=’1. High-level functionality’)</p>
<dl class="field-list simple">
<dt class="field-odd">Purpose</dt>
<dd class="field-odd"><p>Perform background check and quality control for all microwave
satellite radiance observations: AMSU-A, AMSU-B/MHS, ATMS, MWHS2.</p>
</dd>
</dl>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Routines</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest10rttovrejectcheck" title="f/bgckmicrowave_mod/amsuabtest10rttovrejectcheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest10rttovrejectcheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest11radiancegrossvaluecheck" title="f/bgckmicrowave_mod/amsuabtest11radiancegrossvaluecheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest11radiancegrossvaluecheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest15channelselectionwithtovutil" title="f/bgckmicrowave_mod/amsuabtest15channelselectionwithtovutil"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest15channelselectionwithtovutil()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest1topographycheck" title="f/bgckmicrowave_mod/amsuabtest1topographycheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest1topographycheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest2landseaqualifiercheck" title="f/bgckmicrowave_mod/amsuabtest2landseaqualifiercheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest2landseaqualifiercheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest3terraintypecheck" title="f/bgckmicrowave_mod/amsuabtest3terraintypecheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest3terraintypecheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest4fieldofviewcheck" title="f/bgckmicrowave_mod/amsuabtest4fieldofviewcheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest4fieldofviewcheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest5zenithanglecheck" title="f/bgckmicrowave_mod/amsuabtest5zenithanglecheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest5zenithanglecheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest6zenangleandfovconsistencycheck" title="f/bgckmicrowave_mod/amsuabtest6zenangleandfovconsistencycheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest6zenangleandfovconsistencycheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest7landseaqualifyerandmodellandseaconsistencycheck" title="f/bgckmicrowave_mod/amsuabtest7landseaqualifyerandmodellandseaconsistencycheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest7landseaqualifyerandmodellandseaconsistencycheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest9uncorrectedtbcheck" title="f/bgckmicrowave_mod/amsuabtest9uncorrectedtbcheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest9uncorrectedtbcheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuatest12grodyclwcheck" title="f/bgckmicrowave_mod/amsuatest12grodyclwcheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuatest12grodyclwcheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuatest13grodyscatteringindexcheck" title="f/bgckmicrowave_mod/amsuatest13grodyscatteringindexcheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuatest13grodyscatteringindexcheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuatest14roguecheck" title="f/bgckmicrowave_mod/amsuatest14roguecheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuatest14roguecheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuatest16excludeextremescattering" title="f/bgckmicrowave_mod/amsuatest16excludeextremescattering"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuatest16excludeextremescattering()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsubtest12drynessindexcheck" title="f/bgckmicrowave_mod/amsubtest12drynessindexcheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsubtest12drynessindexcheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsubtest13bennartzscatteringindexcheck" title="f/bgckmicrowave_mod/amsubtest13bennartzscatteringindexcheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsubtest13bennartzscatteringindexcheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsubtest14roguecheck" title="f/bgckmicrowave_mod/amsubtest14roguecheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsubtest14roguecheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/atmsmwhs2landicemask" title="f/bgckmicrowave_mod/atmsmwhs2landicemask"><code class="xref f f-func docutils literal notranslate"><span class="pre">atmsmwhs2landicemask()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/atmsmwhs2test1flagbit7check" title="f/bgckmicrowave_mod/atmsmwhs2test1flagbit7check"><code class="xref f f-func docutils literal notranslate"><span class="pre">atmsmwhs2test1flagbit7check()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/atmsmwhs2test2topographycheck" title="f/bgckmicrowave_mod/atmsmwhs2test2topographycheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">atmsmwhs2test2topographycheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/atmsmwhs2test3uncorrectedtbcheck" title="f/bgckmicrowave_mod/atmsmwhs2test3uncorrectedtbcheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">atmsmwhs2test3uncorrectedtbcheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/atmsmwhs2test5channelselectionusingtovutil" title="f/bgckmicrowave_mod/atmsmwhs2test5channelselectionusingtovutil"><code class="xref f f-func docutils literal notranslate"><span class="pre">atmsmwhs2test5channelselectionusingtovutil()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/atmstest4roguecheck" title="f/bgckmicrowave_mod/atmstest4roguecheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">atmstest4roguecheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/calcstatedepobserr" title="f/bgckmicrowave_mod/calcstatedepobserr"><code class="xref f f-func docutils literal notranslate"><span class="pre">calcstatedepobserr()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/extractparamforbennartzrun" title="f/bgckmicrowave_mod/extractparamforbennartzrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">extractparamforbennartzrun()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/extractparamforgrodyrun" title="f/bgckmicrowave_mod/extractparamforgrodyrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">extractparamforgrodyrun()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/grody" title="f/bgckmicrowave_mod/grody"><code class="xref f f-func docutils literal notranslate"><span class="pre">grody()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/iftovsexist" title="f/bgckmicrowave_mod/iftovsexist"><code class="xref f f-func docutils literal notranslate"><span class="pre">iftovsexist()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_bgcheckmw" title="f/bgckmicrowave_mod/mwbg_bgcheckmw"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_bgcheckmw()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_computemwhs2surfacetype" title="f/bgckmicrowave_mod/mwbg_computemwhs2surfacetype"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_computemwhs2surfacetype()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_firstqccheckatms" title="f/bgckmicrowave_mod/mwbg_firstqccheckatms"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_firstqccheckatms()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_firstqccheckmwhs2" title="f/bgckmicrowave_mod/mwbg_firstqccheckmwhs2"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_firstqccheckmwhs2()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_flagdatausingnrlcritatms" title="f/bgckmicrowave_mod/mwbg_flagdatausingnrlcritatms"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_flagdatausingnrlcritatms()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_flagdatausingnrlcritmwhs2" title="f/bgckmicrowave_mod/mwbg_flagdatausingnrlcritmwhs2"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_flagdatausingnrlcritmwhs2()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_grossvaluecheck" title="f/bgckmicrowave_mod/mwbg_grossvaluecheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_grossvaluecheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_init" title="f/bgckmicrowave_mod/mwbg_init"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_init()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_nrlfilteratms" title="f/bgckmicrowave_mod/mwbg_nrlfilteratms"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_nrlfilteratms()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_nrlfiltermwhs2" title="f/bgckmicrowave_mod/mwbg_nrlfiltermwhs2"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_nrlfiltermwhs2()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_qcstats" title="f/bgckmicrowave_mod/mwbg_qcstats"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_qcstats()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_readgeophysicfieldsandinterpolate" title="f/bgckmicrowave_mod/mwbg_readgeophysicfieldsandinterpolate"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_readgeophysicfieldsandinterpolate()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_reviewallcritforfinalflagsatms" title="f/bgckmicrowave_mod/mwbg_reviewallcritforfinalflagsatms"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_reviewallcritforfinalflagsatms()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_reviewallcritforfinalflagsmwhs2" title="f/bgckmicrowave_mod/mwbg_reviewallcritforfinalflagsmwhs2"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_reviewallcritforfinalflagsmwhs2()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsua" title="f/bgckmicrowave_mod/mwbg_tovcheckamsua"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsua()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsub" title="f/bgckmicrowave_mod/mwbg_tovcheckamsub"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsub()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckatms" title="f/bgckmicrowave_mod/mwbg_tovcheckatms"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckatms()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckmwhs2" title="f/bgckmicrowave_mod/mwbg_tovcheckmwhs2"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckmwhs2()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwhs2test4roguecheck" title="f/bgckmicrowave_mod/mwhs2test4roguecheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwhs2test4roguecheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/resetqccases" title="f/bgckmicrowave_mod/resetqccases"><code class="xref f f-func docutils literal notranslate"><span class="pre">resetqccases()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/setterraintypetoseaice" title="f/bgckmicrowave_mod/setterraintypetoseaice"><code class="xref f f-func docutils literal notranslate"><span class="pre">setterraintypetoseaice()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="midasmpi_mod.html#f/midasmpi_mod" title="f/midasmpi_mod: MODULE midasMpi_mod (prefix='mmpi' category='8. Low-level utilities and constants')"><code class="xref f f-mod docutils literal notranslate"><span class="pre">midasmpi_mod</span></code></a>: MODULE midasMpi_mod (prefix=’mmpi’ category=’8. Low-level utilities and constants’)</p></li>
<li><p><a class="reference internal" href="mathphysconstants_mod.html#f/mathphysconstants_mod" title="f/mathphysconstants_mod: MODULE mathPhysConstants_mod (prefix='mpc' category='8. Low-level utilities and constants')"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mathphysconstants_mod</span></code></a>: MODULE mathPhysConstants_mod (prefix=’mpc’ category=’8. Low-level utilities and constants’)</p></li>
<li><p><a class="reference internal" href="utilities_mod.html#f/utilities_mod" title="f/utilities_mod: MODULE utilities_mod (prefix='utl' category='8. Low-level utilities and constants')"><code class="xref f f-mod docutils literal notranslate"><span class="pre">utilities_mod</span></code></a>: MODULE utilities_mod (prefix=’utl’ category=’8. Low-level utilities and constants’)</p></li>
<li><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod" title="f/obsspacedata_mod: MODULE obsSpaceData_mod (prefix='obs' category='6. High-level data objects')"><code class="xref f f-mod docutils literal notranslate"><span class="pre">obsspacedata_mod</span></code></a>: MODULE obsSpaceData_mod (prefix=’obs’ category=’6. High-level data objects’)</p></li>
<li><p><a class="reference internal" href="tovsnl_mod.html#f/tovsnl_mod" title="f/tovsnl_mod: MODULE tovsNL_mod (prefix='tvs' category='5. Observation operators')"><code class="xref f f-mod docutils literal notranslate"><span class="pre">tovsnl_mod</span></code></a>: MODULE tovsNL_mod (prefix=’tvs’ category=’5. Observation operators’)</p></li>
<li><p><a class="reference internal" href="obserrors_mod.html#f/obserrors_mod" title="f/obserrors_mod: MODULE obsErrors_mod (prefix='oer' category='2. B and R matrices')"><code class="xref f f-mod docutils literal notranslate"><span class="pre">obserrors_mod</span></code></a>: MODULE obsErrors_mod (prefix=’oer’ category=’2. B and R matrices’)</p></li>
<li><p><a class="reference internal" href="codtyp_mod.html#f/codtyp_mod" title="f/codtyp_mod: MODULE codtyp_mod (prefix='codtyp' category='8. Low-level utilities and constants')"><code class="xref f f-mod docutils literal notranslate"><span class="pre">codtyp_mod</span></code></a>: MODULE codtyp_mod (prefix=’codtyp’ category=’8. Low-level utilities and constants’)</p></li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/mwbg_init">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">mwbg_init</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/mwbg_init" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>This subroutine reads the namelist section NAMBGCK for the module.</p>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_computemwhs2surfacetype" title="f/bgckmicrowave_mod/mwbg_computemwhs2surfacetype"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_computemwhs2surfacetype()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_bgcheckmw" title="f/bgckmicrowave_mod/mwbg_bgcheckmw"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_bgcheckmw()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="utilities_mod.html#f/utilities_mod/utl_abort" title="f/utilities_mod/utl_abort"><code class="xref f f-func docutils literal notranslate"><span class="pre">utl_abort()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/extractparamforgrodyrun">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">extractparamforgrodyrun</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tb23</span></em>, <em class="sig-param"><span class="pre">tb31</span></em>, <em class="sig-param"><span class="pre">tb50</span></em>, <em class="sig-param"><span class="pre">tb53</span></em>, <em class="sig-param"><span class="pre">tb89</span></em>, <em class="sig-param"><span class="pre">tb23fg</span></em>, <em class="sig-param"><span class="pre">tb31fg</span></em>, <em class="sig-param"><span class="pre">tb50fg</span></em>, <em class="sig-param"><span class="pre">tb53fg</span></em>, <em class="sig-param"><span class="pre">tb89fg</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/extractparamforgrodyrun" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>Compute  Grody parameters by extracting tb for required channels:
- 23 Ghz = AMSU-A 1 = channel #28
- 31 Ghz = AMSU-A 2 = channel #29
- 50 Ghz = AMSU-A 3 = channel #30
- 53 Ghz = AMSU-A 5 = channel #32
- 89 Ghz = AMSU-A15 = channel #42</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>tb23</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: radiance frequence 23 Ghz</p></li>
<li><p><strong>tb31</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: radiance frequence 31 Ghz</p></li>
<li><p><strong>tb50</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: radiance frequence 50 Ghz</p></li>
<li><p><strong>tb53</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: radiance frequence 53 Ghz</p></li>
<li><p><strong>tb89</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: radiance frequence 89 Ghz</p></li>
<li><p><strong>tb23fg</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: radiance frequence 23 Ghz</p></li>
<li><p><strong>tb31fg</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: radiance frequence 31 Ghz</p></li>
<li><p><strong>tb50fg</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: radiance frequence 50 Ghz</p></li>
<li><p><strong>tb53fg</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: radiance frequence 53 Ghz</p></li>
<li><p><strong>tb89fg</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: radiance frequence 89 Ghz</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsua" title="f/bgckmicrowave_mod/mwbg_tovcheckamsua"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsua()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/extractparamforbennartzrun">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">extractparamforbennartzrun</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tb89</span></em>, <em class="sig-param"><span class="pre">tb150</span></em>, <em class="sig-param"><span class="pre">tb1831</span></em>, <em class="sig-param"><span class="pre">tb1832</span></em>, <em class="sig-param"><span class="pre">tb1833</span></em>, <em class="sig-param"><span class="pre">tb89fg</span></em>, <em class="sig-param"><span class="pre">tb150fg</span></em>, <em class="sig-param"><span class="pre">tb89fgclear</span></em>, <em class="sig-param"><span class="pre">tb150fgclear</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/extractparamforbennartzrun" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>Extract Parameters required to run bennaertz for required channels:
- 89 Ghz = AMSU-B 1 = channel #43
- 150 Ghz = AMSU-B 2 = channel #44</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>tb89</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: 89GHz radiance from observation</p></li>
<li><p><strong>tb150</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: 150GHz radiance from observation</p></li>
<li><p><strong>tb1831</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: 183GHz radiance from observation</p></li>
<li><p><strong>tb1832</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: 183GHz radiance from observation</p></li>
<li><p><strong>tb1833</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: 183GHz radiance from observation</p></li>
<li><p><strong>tb89fg</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: 89GHz radiance from background</p></li>
<li><p><strong>tb150fg</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: 150GHz radiance from background</p></li>
<li><p><strong>tb89fgclear</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: 89GHz clear-sky radiance from background</p></li>
<li><p><strong>tb150fgclear</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: 150GHz clear-sky radiance from background</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsub" title="f/bgckmicrowave_mod/mwbg_tovcheckamsub"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsub()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="tovsnl_mod.html#f/tovsnl_mod/tvs_isinstrumallskyhuassim" title="f/tovsnl_mod/tvs_isinstrumallskyhuassim"><code class="xref f f-func docutils literal notranslate"><span class="pre">tvs_isinstrumallskyhuassim()</span></code></a>, <a class="reference internal" href="tovsnl_mod.html#f/tovsnl_mod/tvs_getinstrumentid" title="f/tovsnl_mod/tvs_getinstrumentid"><code class="xref f f-func docutils literal notranslate"><span class="pre">tvs_getinstrumentid()</span></code></a>, <a class="reference internal" href="codtyp_mod.html#f/codtyp_mod/codtyp_get_name" title="f/codtyp_mod/codtyp_get_name"><code class="xref f f-func docutils literal notranslate"><span class="pre">codtyp_get_name()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/amsuabtest10rttovrejectcheck">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">amsuabtest10rttovrejectcheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">resetqc</span></em>, <em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/amsuabtest10rttovrejectcheck" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>test 10: RTTOV reject check (single).
Rejected datum flag has bit #9 on.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>resetqc</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: yes or not reset QC flag</p></li>
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: indicateur du QC par canal</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsua" title="f/bgckmicrowave_mod/mwbg_tovcheckamsua"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsua()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsub" title="f/bgckmicrowave_mod/mwbg_tovcheckamsub"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsub()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_elem_c" title="f/obsspacedata_mod/obs_elem_c"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_elem_c()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/amsuabtest1topographycheck">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">amsuabtest1topographycheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">modelinterpterrain</span></em>, <em class="sig-param"><span class="pre">channelfortopofilter</span></em>, <em class="sig-param"><span class="pre">altitudefortopofilter</span></em>, <em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/amsuabtest1topographycheck" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>test 1: Topography check (partial)
Channel 6 is rejected for topography &gt;  250m.
Channel 7 is rejected for topography &gt; 2000m.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>modelinterpterrain</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: topo aux point d’obs</p></li>
<li><p><strong>channelfortopofilter</strong> (*)<em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: channel list for filter</p></li>
<li><p><strong>altitudefortopofilter</strong> (*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: altitude threshold</p></li>
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: indicateur du QC par canal</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsua" title="f/bgckmicrowave_mod/mwbg_tovcheckamsua"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsua()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsub" title="f/bgckmicrowave_mod/mwbg_tovcheckamsub"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsub()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="utilities_mod.html#f/utilities_mod/utl_abort" title="f/utilities_mod/utl_abort"><code class="xref f f-func docutils literal notranslate"><span class="pre">utl_abort()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_elem_c" title="f/obsspacedata_mod/obs_elem_c"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_elem_c()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/amsuabtest2landseaqualifiercheck">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">amsuabtest2landseaqualifiercheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/amsuabtest2landseaqualifiercheck" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>test 2: “Land/sea qualifier” code check (full)
allowed values are: 0 land, 1 sea, 2 coast.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: indicateur du QC par canal</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsua" title="f/bgckmicrowave_mod/mwbg_tovcheckamsua"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsua()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsub" title="f/bgckmicrowave_mod/mwbg_tovcheckamsub"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsub()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_elem_c" title="f/obsspacedata_mod/obs_elem_c"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_elem_c()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/amsuabtest3terraintypecheck">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">amsuabtest3terraintypecheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/amsuabtest3terraintypecheck" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>test 3: “Terrain type” code check (full)
allowed values are: -1 missing, 0 sea-ice, 1 snow on land.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: indicateur du QC par canal</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsua" title="f/bgckmicrowave_mod/mwbg_tovcheckamsua"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsua()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsub" title="f/bgckmicrowave_mod/mwbg_tovcheckamsub"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsub()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_elem_c" title="f/obsspacedata_mod/obs_elem_c"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_elem_c()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/amsuabtest4fieldofviewcheck">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">amsuabtest4fieldofviewcheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">maxscanangleamsu</span></em>, <em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/amsuabtest4fieldofviewcheck" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>test 4: Field of view number check (full)
Field of view acceptable range is [1,maxScanAngleAMSU] for AMSU footprints.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>maxscanangleamsu</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: max scan angle</p></li>
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: indicateur du QC par canal</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsua" title="f/bgckmicrowave_mod/mwbg_tovcheckamsua"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsua()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsub" title="f/bgckmicrowave_mod/mwbg_tovcheckamsub"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsub()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_elem_c" title="f/obsspacedata_mod/obs_elem_c"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_elem_c()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/amsuabtest5zenithanglecheck">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">amsuabtest5zenithanglecheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/amsuabtest5zenithanglecheck" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>test 5: Satellite zenith angle check (full)
Satellite zenith angle acceptable range is [0.,60.].</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: indicateur du QC par canal</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsua" title="f/bgckmicrowave_mod/mwbg_tovcheckamsua"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsua()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsub" title="f/bgckmicrowave_mod/mwbg_tovcheckamsub"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsub()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_r" title="f/obsspacedata_mod/obs_headelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_elem_c" title="f/obsspacedata_mod/obs_elem_c"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_elem_c()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/amsuabtest6zenangleandfovconsistencycheck">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">amsuabtest6zenangleandfovconsistencycheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">zangl</span></em>, <em class="sig-param"><span class="pre">maxscanangleamsu</span></em>, <em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/amsuabtest6zenangleandfovconsistencycheck" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>test 6: “Sat. zenith angle”/”field of view” consistency check.  (full)
Acceptable difference between “Satellite zenith angle”  and
“approximate angle computed from field of view number” is 1.8 degrees.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>zangl</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: satellite constant param</p></li>
<li><p><strong>maxscanangleamsu</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: max scan angle</p></li>
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: indicateur du QC par canal</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsua" title="f/bgckmicrowave_mod/mwbg_tovcheckamsua"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsua()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsub" title="f/bgckmicrowave_mod/mwbg_tovcheckamsub"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsub()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_r" title="f/obsspacedata_mod/obs_headelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_elem_c" title="f/obsspacedata_mod/obs_elem_c"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_elem_c()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/amsuabtest7landseaqualifyerandmodellandseaconsistencycheck">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">amsuabtest7landseaqualifyerandmodellandseaconsistencycheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">modelinterplandfrac</span></em>, <em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/amsuabtest7landseaqualifyerandmodellandseaconsistencycheck" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>test 7: “Land/sea qual.”/”model land/sea” consistency check (full).
Acceptable conditions are:</p>
<blockquote>
<div><ul class="simple">
<li><p>both over ocean (landQualifierIndice=1; mg&lt;0.01), new threshold 0.20, jh dec 2000,</p></li>
<li><p>both over land  (landQualifierIndice=0; mg&gt;0.80), new threshold 0.50, jh dec 2000.</p></li>
</ul>
</div></blockquote>
<p>All other conditions are unacceptable.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>modelinterplandfrac</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: model interpolated land fraction</p></li>
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: indicateur du QC par canal</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsua" title="f/bgckmicrowave_mod/mwbg_tovcheckamsua"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsua()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsub" title="f/bgckmicrowave_mod/mwbg_tovcheckamsub"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsub()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_elem_c" title="f/obsspacedata_mod/obs_elem_c"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_elem_c()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/amsuabtest9uncorrectedtbcheck">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">amsuabtest9uncorrectedtbcheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">resetqc</span></em>, <em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/amsuabtest9uncorrectedtbcheck" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>test 9: Uncorrected Tb check (single).
Uncorrected datum (flag bit #6 off). In this case switch bit 11 ON.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>resetqc</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: yes or not reset QC flag</p></li>
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: indicateur du QC par canal</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsua" title="f/bgckmicrowave_mod/mwbg_tovcheckamsua"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsua()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_elem_c" title="f/obsspacedata_mod/obs_elem_c"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_elem_c()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/amsuabtest11radiancegrossvaluecheck">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">amsuabtest11radiancegrossvaluecheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">grossmin</span></em>, <em class="sig-param"><span class="pre">grossmax</span></em>, <em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/amsuabtest11radiancegrossvaluecheck" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>test 11: Radiance observation “Gross” check (single).
Change this test from full to single. jh nov 2000.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>grossmin</strong> (*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: Gross val min</p></li>
<li><p><strong>grossmax</strong> (*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: Gross val max</p></li>
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: indicateur du QC par canal</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsua" title="f/bgckmicrowave_mod/mwbg_tovcheckamsua"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsua()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsub" title="f/bgckmicrowave_mod/mwbg_tovcheckamsub"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsub()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_elem_c" title="f/obsspacedata_mod/obs_elem_c"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_elem_c()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/amsuatest12grodyclwcheck">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">amsuatest12grodyclwcheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">iclwrej</span></em>, <em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/amsuatest12grodyclwcheck" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>test 12: Grody cloud liquid water check (partial).</p>
<p>For Cloud Liquid Water &gt; clwQcThreshold, reject AMSUA-A channels 1-5 and 15.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>iclwrej</strong> (*)<em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: rejection channel list</p></li>
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: indicateur du QC par canal</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsua" title="f/bgckmicrowave_mod/mwbg_tovcheckamsua"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsua()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_r" title="f/obsspacedata_mod/obs_headelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_elem_c" title="f/obsspacedata_mod/obs_elem_c"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_elem_c()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/amsubtest12drynessindexcheck">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">amsubtest12drynessindexcheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">tb1831</span></em>, <em class="sig-param"><span class="pre">tb1833</span></em>, <em class="sig-param"><span class="pre">modelinterpseaice</span></em>, <em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">skiptestarr_opt</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/amsubtest12drynessindexcheck" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>test 12: Dryness index check.
The difference between channels AMSUB-3 and AMSUB-5 is used as an indicator
of “dryness” of the atmosphere. In extreme dry conditions, channels AMSUB-3 4 and 5
are sensitive to the surface.
Therefore, various thresholds are used to reject channels AMSUB-3 4 and 5 over land and ice</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>tb1831</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: tb for channel</p></li>
<li><p><strong>tb1833</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: tb for channel</p></li>
<li><p><strong>modelinterpseaice</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: topo interpolated to obs point</p></li>
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: indicateur du QC par canal</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><strong>skiptestarr_opt</strong> (*)<em> [</em><em>logical </em><em>,</em><em>in,</em><em>]</em> :: array to set to skip the test</p>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsub" title="f/bgckmicrowave_mod/mwbg_tovcheckamsub"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsub()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_elem_c" title="f/obsspacedata_mod/obs_elem_c"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_elem_c()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/amsuatest13grodyscatteringindexcheck">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">amsuatest13grodyscatteringindexcheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">iscatrej</span></em>, <em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/amsuatest13grodyscatteringindexcheck" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>test 13: Grody scattering index check (partial).</p>
<p>For Scattering Index &gt; 9, reject AMSUA-A channels 1-6 and 15.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>iscatrej</strong> (*)<em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: rejection channel list</p></li>
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: indicateur du QC par canal</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsua" title="f/bgckmicrowave_mod/mwbg_tovcheckamsua"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsua()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_r" title="f/obsspacedata_mod/obs_headelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_elem_c" title="f/obsspacedata_mod/obs_elem_c"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_elem_c()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/amsubtest13bennartzscatteringindexcheck">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">amsubtest13bennartzscatteringindexcheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">scatindexoverlandobs</span></em>, <em class="sig-param"><span class="pre">modelinterpseaice</span></em>, <em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">chanignoreinallskygencoeff</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">skiptestarr_opt</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/amsubtest13bennartzscatteringindexcheck" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>test 13: Bennartz scattering index check (full).
For Scattering Index:</p>
<blockquote>
<div><ul class="simple">
<li><p>&gt; 40 sea ice,</p></li>
<li><p>&gt; 15 sea,</p></li>
<li><p>&gt; 0 land reject all AMSUB Channels</p></li>
</ul>
</div></blockquote>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>scatindexoverlandobs</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: scattering index over land</p></li>
<li><p><strong>modelinterpseaice</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: glace de mer</p></li>
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: indicateur du QC par canal</p></li>
<li><p><strong>chanignoreinallskygencoeff</strong> (*)<em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: channels to exclude from genCoeff</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><strong>skiptestarr_opt</strong> (*)<em> [</em><em>logical </em><em>,</em><em>in,</em><em>]</em> :: array to set to skip the test</p>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsub" title="f/bgckmicrowave_mod/mwbg_tovcheckamsub"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsub()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_r" title="f/obsspacedata_mod/obs_headelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_elem_c" title="f/obsspacedata_mod/obs_elem_c"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_elem_c()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/amsuatest14roguecheck">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">amsuatest14roguecheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">roguefac</span></em>, <em class="sig-param"><span class="pre">isfcrej</span></em>, <em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/amsuatest14roguecheck" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>test 14: “Rogue check” for (O-P) Tb residuals out of range.
(single/full). Les observations, dont le residu (O-P)
depasse par un facteur (roguefac) l’erreur totale des TOVS.</p>
<p>N.B.: a reject by any of the 3 surface channels produces the
rejection of AMSUA-A channels 1-5 and 15.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>roguefac</strong> (*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: rogue factor</p></li>
<li><p><strong>isfcrej</strong> (*)<em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: rejection channel list</p></li>
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: indicateur du QC par canal</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsua" title="f/bgckmicrowave_mod/mwbg_tovcheckamsua"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsua()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_r" title="f/obsspacedata_mod/obs_headelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_elem_c" title="f/obsspacedata_mod/obs_elem_c"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_elem_c()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/calcstatedepobserr" title="f/bgckmicrowave_mod/calcstatedepobserr"><code class="xref f f-func docutils literal notranslate"><span class="pre">calcstatedepobserr()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/amsubtest14roguecheck">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">amsubtest14roguecheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">roguefac</span></em>, <em class="sig-param"><span class="pre">ich2omprej</span></em>, <em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">skiptestarr_opt</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/amsubtest14roguecheck" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>test 14: “Rogue check” for (O-P) Tb residuals out of range. (single)
Also, remove CH2,3,4,5 if CH2 <a href="#id9"><span class="problematic" id="id10">|O-P|</span></a>&gt;5K (partial)</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>roguefac</strong> (*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: rogue factor</p></li>
<li><p><strong>ich2omprej</strong> (*)<em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: rejection channel list</p></li>
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: indicateur du QC par canal</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><strong>skiptestarr_opt</strong> (*)<em> [</em><em>logical </em><em>,</em><em>in,</em><em>]</em> :: array to set to skip the test</p>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsub" title="f/bgckmicrowave_mod/mwbg_tovcheckamsub"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsub()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_r" title="f/obsspacedata_mod/obs_headelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_elem_c" title="f/obsspacedata_mod/obs_elem_c"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_elem_c()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/calcstatedepobserr" title="f/bgckmicrowave_mod/calcstatedepobserr"><code class="xref f f-func docutils literal notranslate"><span class="pre">calcstatedepobserr()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/amsuabtest15channelselectionwithtovutil">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">amsuabtest15channelselectionwithtovutil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">modelinterpseaice</span></em>, <em class="sig-param"><span class="pre">isfcrej2</span></em>, <em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/amsuabtest15channelselectionwithtovutil" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><dl class="simple">
<dt>test 15: Channel Selection using array oer_tovutil(chan,sat):</dt><dd><ul class="simple">
<li><p>= 0 blacklisted,</p></li>
<li><p>= 1 assmilate,</p></li>
<li><p>= 2 assimilate over open water only</p></li>
</ul>
</dd>
</dl>
<p>We set QC flag bits 7 and 9 ON for channels with oer_tovutil=2
over land or sea-ice.</p>
<p>We set QC flag bits 7 and 9 ON for channels
1-3, 15 over land or sea-ice REGARDLESS of oer_tovutil value
(but oer_tovutil=0 always for these unassimilated channels).</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>modelinterpseaice</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: gl</p></li>
<li><p><strong>isfcrej2</strong> (*)<em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: rejection channel list</p></li>
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: indicateur du QC par canal</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsua" title="f/bgckmicrowave_mod/mwbg_tovcheckamsua"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsua()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsub" title="f/bgckmicrowave_mod/mwbg_tovcheckamsub"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsub()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_elem_c" title="f/obsspacedata_mod/obs_elem_c"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_elem_c()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/amsuatest16excludeextremescattering">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">amsuatest16excludeextremescattering</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/amsuatest16excludeextremescattering" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>Exclude radiances affected extreme scattering in deep convective region.
For channel 5, if BT_cld-BT_clr &lt; -0.5 OR O-BT_clr &lt; -0.5, reject channels 4-5.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: indicateur du QC par canal</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsua" title="f/bgckmicrowave_mod/mwbg_tovcheckamsua"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsua()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_elem_c" title="f/obsspacedata_mod/obs_elem_c"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_elem_c()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a>, <a class="reference internal" href="tovsnl_mod.html#f/tovsnl_mod/tvs_isinstrumallskyttassim" title="f/tovsnl_mod/tvs_isinstrumallskyttassim"><code class="xref f f-func docutils literal notranslate"><span class="pre">tvs_isinstrumallskyttassim()</span></code></a>, <a class="reference internal" href="tovsnl_mod.html#f/tovsnl_mod/tvs_getinstrumentid" title="f/tovsnl_mod/tvs_getinstrumentid"><code class="xref f f-func docutils literal notranslate"><span class="pre">tvs_getinstrumentid()</span></code></a>, <a class="reference internal" href="codtyp_mod.html#f/codtyp_mod/codtyp_get_name" title="f/codtyp_mod/codtyp_get_name"><code class="xref f f-func docutils literal notranslate"><span class="pre">codtyp_get_name()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/mwbg_tovcheckamsua">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">mwbg_tovcheckamsua</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">modelinterplandfrac</span></em>, <em class="sig-param"><span class="pre">modelinterpterrain</span></em>, <em class="sig-param"><span class="pre">modelinterpseaice</span></em>, <em class="sig-param"><span class="pre">resetqc</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsua" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>Effectuer le controle de qualite des radiances tovs.</p>
<dl class="simple">
<dt>Quinze tests sont effectues menant aux erreurs suivantes:</dt><dd><ul class="simple">
<li><ol class="arabic simple">
<li><p>topography reject,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="2">
<li><p>invalid land/sea qualifier,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="3">
<li><p>invalid terrain type,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="4">
<li><p>invalid field of view number,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="5">
<li><p>satellite zenith angle out of range,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="6">
<li><p>inconsistent field of view and sat. zenith angle,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="7">
<li><p>inconsistent land/sea qualifier and model mask,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="8">
<li><p>inconsistent terrain type and model ice, (NOT USED)</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="9">
<li><p>uncorrected radiance,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="10">
<li><p>rejected by RTTOV,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="11">
<li><p>radiance gross check failure,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="12">
<li><p>cloud liquid water reject,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="13">
<li><p>scattering index reject,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="14">
<li><p>radiance residual rogue check failure,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="15">
<li><p>channel reject (channel selection).</p></li>
</ol>
</li>
<li><p><a href="#id1"><span class="problematic" id="id2">**</span></a>) set terrain type to sea ice given certain conditions</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>out,allocatable</em><em>]</em> :: indicateur controle de qualite tovs par canal (=0 ok, &gt;0 rejet)</p></li>
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>modelinterplandfrac</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: masque terre/mer du modele</p></li>
<li><p><strong>modelinterpterrain</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: topographie du modele</p></li>
<li><p><strong>modelinterpseaice</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: etendue de glace du modele</p></li>
<li><p><strong>resetqc</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: reset du controle de qualite?</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_bgcheckmw" title="f/bgckmicrowave_mod/mwbg_bgcheckmw"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_bgcheckmw()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/extractparamforgrodyrun" title="f/bgckmicrowave_mod/extractparamforgrodyrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">extractparamforgrodyrun()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/grody" title="f/bgckmicrowave_mod/grody"><code class="xref f f-func docutils literal notranslate"><span class="pre">grody()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest10rttovrejectcheck" title="f/bgckmicrowave_mod/amsuabtest10rttovrejectcheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest10rttovrejectcheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest1topographycheck" title="f/bgckmicrowave_mod/amsuabtest1topographycheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest1topographycheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest2landseaqualifiercheck" title="f/bgckmicrowave_mod/amsuabtest2landseaqualifiercheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest2landseaqualifiercheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest3terraintypecheck" title="f/bgckmicrowave_mod/amsuabtest3terraintypecheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest3terraintypecheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest4fieldofviewcheck" title="f/bgckmicrowave_mod/amsuabtest4fieldofviewcheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest4fieldofviewcheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest5zenithanglecheck" title="f/bgckmicrowave_mod/amsuabtest5zenithanglecheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest5zenithanglecheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest6zenangleandfovconsistencycheck" title="f/bgckmicrowave_mod/amsuabtest6zenangleandfovconsistencycheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest6zenangleandfovconsistencycheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest7landseaqualifyerandmodellandseaconsistencycheck" title="f/bgckmicrowave_mod/amsuabtest7landseaqualifyerandmodellandseaconsistencycheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest7landseaqualifyerandmodellandseaconsistencycheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest9uncorrectedtbcheck" title="f/bgckmicrowave_mod/amsuabtest9uncorrectedtbcheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest9uncorrectedtbcheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest11radiancegrossvaluecheck" title="f/bgckmicrowave_mod/amsuabtest11radiancegrossvaluecheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest11radiancegrossvaluecheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuatest12grodyclwcheck" title="f/bgckmicrowave_mod/amsuatest12grodyclwcheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuatest12grodyclwcheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuatest13grodyscatteringindexcheck" title="f/bgckmicrowave_mod/amsuatest13grodyscatteringindexcheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuatest13grodyscatteringindexcheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuatest14roguecheck" title="f/bgckmicrowave_mod/amsuatest14roguecheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuatest14roguecheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest15channelselectionwithtovutil" title="f/bgckmicrowave_mod/amsuabtest15channelselectionwithtovutil"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest15channelselectionwithtovutil()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuatest16excludeextremescattering" title="f/bgckmicrowave_mod/amsuatest16excludeextremescattering"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuatest16excludeextremescattering()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/resetqccases" title="f/bgckmicrowave_mod/resetqccases"><code class="xref f f-func docutils literal notranslate"><span class="pre">resetqccases()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headset_i" title="f/obsspacedata_mod/obs_headset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headset_i()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/setterraintypetoseaice" title="f/bgckmicrowave_mod/setterraintypetoseaice"><code class="xref f f-func docutils literal notranslate"><span class="pre">setterraintypetoseaice()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/mwbg_tovcheckamsub">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">mwbg_tovcheckamsub</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">modelinterplandfrac</span></em>, <em class="sig-param"><span class="pre">modelinterpterrain</span></em>, <em class="sig-param"><span class="pre">modelinterpseaice</span></em>, <em class="sig-param"><span class="pre">resetqc</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsub" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>Effectuer le controle de qualite des radiances tovs.</p>
<dl class="simple">
<dt>Quinze tests sont effectues menant aux erreurs suivantes:</dt><dd><ul class="simple">
<li><ol class="arabic simple">
<li><p>topography reject,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="2">
<li><p>invalid land/sea qualifier,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="3">
<li><p>invalid terrain type,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="4">
<li><p>invalid field of view number,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="5">
<li><p>satellite zenith angle out of range,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="6">
<li><p>inconsistent field of view and sat. zenith angle,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="7">
<li><p>inconsistent land/sea qualifier and model mask,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="8">
<li><p>inconsistent terrain type and model ice</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="9">
<li><p>uncorrected radiance,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="10">
<li><p>rejected by RTTOV,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="11">
<li><p>radiance gross check failure,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="12">
<li><p>drynes index reject</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="13">
<li><p>scattering index reject,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="14">
<li><p>radiance residual rogue check failure,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="15">
<li><p>channel reject (channel selection).</p></li>
</ol>
</li>
<li><p><a href="#id3"><span class="problematic" id="id4">**</span></a>) set terrain type to sea ice given certain conditions</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>out,allocatable</em><em>]</em> :: indicateur controle de qualite tovs par canal (=0 ok, &gt;0 rejet)</p></li>
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>modelinterplandfrac</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: masque terre/mer du modele</p></li>
<li><p><strong>modelinterpterrain</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: topographie du modele</p></li>
<li><p><strong>modelinterpseaice</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: etendue de glace du modele</p></li>
<li><p><strong>resetqc</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: reset du controle de qualite?</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_bgcheckmw" title="f/bgckmicrowave_mod/mwbg_bgcheckmw"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_bgcheckmw()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/extractparamforbennartzrun" title="f/bgckmicrowave_mod/extractparamforbennartzrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">extractparamforbennartzrun()</span></code></a>, <a class="reference internal" href="bgckssmis_mod.html#f/bgckssmis_mod/bennartz" title="f/bgckssmis_mod/bennartz"><code class="xref f f-func docutils literal notranslate"><span class="pre">bennartz()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest10rttovrejectcheck" title="f/bgckmicrowave_mod/amsuabtest10rttovrejectcheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest10rttovrejectcheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest1topographycheck" title="f/bgckmicrowave_mod/amsuabtest1topographycheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest1topographycheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest2landseaqualifiercheck" title="f/bgckmicrowave_mod/amsuabtest2landseaqualifiercheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest2landseaqualifiercheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest3terraintypecheck" title="f/bgckmicrowave_mod/amsuabtest3terraintypecheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest3terraintypecheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest4fieldofviewcheck" title="f/bgckmicrowave_mod/amsuabtest4fieldofviewcheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest4fieldofviewcheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest5zenithanglecheck" title="f/bgckmicrowave_mod/amsuabtest5zenithanglecheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest5zenithanglecheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest6zenangleandfovconsistencycheck" title="f/bgckmicrowave_mod/amsuabtest6zenangleandfovconsistencycheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest6zenangleandfovconsistencycheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest7landseaqualifyerandmodellandseaconsistencycheck" title="f/bgckmicrowave_mod/amsuabtest7landseaqualifyerandmodellandseaconsistencycheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest7landseaqualifyerandmodellandseaconsistencycheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest11radiancegrossvaluecheck" title="f/bgckmicrowave_mod/amsuabtest11radiancegrossvaluecheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest11radiancegrossvaluecheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsubtest12drynessindexcheck" title="f/bgckmicrowave_mod/amsubtest12drynessindexcheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsubtest12drynessindexcheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsubtest13bennartzscatteringindexcheck" title="f/bgckmicrowave_mod/amsubtest13bennartzscatteringindexcheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsubtest13bennartzscatteringindexcheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsubtest14roguecheck" title="f/bgckmicrowave_mod/amsubtest14roguecheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsubtest14roguecheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsuabtest15channelselectionwithtovutil" title="f/bgckmicrowave_mod/amsuabtest15channelselectionwithtovutil"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuabtest15channelselectionwithtovutil()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/resetqccases" title="f/bgckmicrowave_mod/resetqccases"><code class="xref f f-func docutils literal notranslate"><span class="pre">resetqccases()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headset_i" title="f/obsspacedata_mod/obs_headset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headset_i()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/setterraintypetoseaice" title="f/bgckmicrowave_mod/setterraintypetoseaice"><code class="xref f f-func docutils literal notranslate"><span class="pre">setterraintypetoseaice()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/mwbg_qcstats">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">mwbg_qcstats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">instname</span></em>, <em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">satelliteid</span></em>, <em class="sig-param"><span class="pre">ldprint</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/mwbg_qcstats" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>Cumuler ou imprimer des statistiques decriptives des rejets tovs.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>instname</strong><em> [</em><em>character </em><em>,</em><em>in</em><em>]</em> :: Instrument Name</p></li>
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: indicateur controle de qualite tovs par canal (=0 ok, &gt;0 rejet)</p></li>
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero d’identificateur du satellite</p></li>
<li><p><strong>satelliteid</strong> (*)<em> [</em><em>character </em><em>,</em><em>in</em><em>]</em> :: identificateur du satellite</p></li>
<li><p><strong>ldprint</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: mode: imprimer ou cumuler?</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_bgcheckmw" title="f/bgckmicrowave_mod/mwbg_bgcheckmw"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_bgcheckmw()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/resetqccases">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">resetqccases</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">resetqc</span></em>, <em class="sig-param"><span class="pre">kchkprf</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/resetqccases" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>allumer la bit (6) indiquant que l’observation a un element
rejete par le controle de qualite de l’AO.</p>
<p>N.B.: si on est en mode resetqc, on remet le marqueur global a
sa valeur de defaut, soit 1024,  avant de faire la mise a jour.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>resetqc</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: reset the quality control flags before adding the new ones ?</p></li>
<li><p><strong>kchkprf</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: indicateur global controle de qualite tovs. Code:</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsua" title="f/bgckmicrowave_mod/mwbg_tovcheckamsua"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsua()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsub" title="f/bgckmicrowave_mod/mwbg_tovcheckamsub"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsub()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckatms" title="f/bgckmicrowave_mod/mwbg_tovcheckatms"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckatms()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckmwhs2" title="f/bgckmicrowave_mod/mwbg_tovcheckmwhs2"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckmwhs2()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headset_i" title="f/obsspacedata_mod/obs_headset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/setterraintypetoseaice">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">setterraintypetoseaice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">modelinterpseaice</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/setterraintypetoseaice" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><dl class="simple">
<dt>Dans les conditions suivantes:</dt><dd><ol class="arabic simple">
<li><p>l’indicateur terre/mer indique l’ocean (landQualifierIndice=1),</p></li>
<li><p>le “terrain type” est manquant (terrainTypeIndice=-1),</p></li>
<li><p>le modele indique de la glace (gl &gt;= 0.01),</p></li>
</ol>
</dd>
</dl>
<p>on specifie “sea ice” pour le “terrain type” (terrainTypeIndice=0).</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>modelinterpseaice</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: sea ice</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsua" title="f/bgckmicrowave_mod/mwbg_tovcheckamsua"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsua()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsub" title="f/bgckmicrowave_mod/mwbg_tovcheckamsub"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsub()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headset_i" title="f/obsspacedata_mod/obs_headset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/grody">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">grody</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tb23</span></em>, <em class="sig-param"><span class="pre">tb31</span></em>, <em class="sig-param"><span class="pre">tb50</span></em>, <em class="sig-param"><span class="pre">tb53</span></em>, <em class="sig-param"><span class="pre">tb89</span></em>, <em class="sig-param"><span class="pre">tb23fg</span></em>, <em class="sig-param"><span class="pre">tb31fg</span></em>, <em class="sig-param"><span class="pre">ice</span></em>, <em class="sig-param"><span class="pre">tpw</span></em>, <em class="sig-param"><span class="pre">rain</span></em>, <em class="sig-param"><span class="pre">snow</span></em>, <em class="sig-param"><span class="pre">scatindexoverlandobs</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/grody" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><dl class="simple">
<dt>Compute the following parameters using 5 AMSU-A channels:</dt><dd><ul class="simple">
<li><p>sea ice,</p></li>
<li><p>total precipitable water,</p></li>
<li><p>cloud liquid water,</p></li>
<li><p>ocean/land rain,</p></li>
<li><p>&lt;snow&gt; cover/glacial ice,</p></li>
<li><p>scattering index (sur la terre et sur l’eau).</p></li>
</ul>
</dd>
</dl>
<p>The four channels used are: 23Ghz, 31Ghz, 50Ghz and 89Ghz.
REGERENCES N. Grody, NOAA/NESDIS, ….</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>tb23</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: 23Ghz brightness temperature (K)</p></li>
<li><p><strong>tb31</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: 31Ghz brightness temperature (K)</p></li>
<li><p><strong>tb50</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: 50Ghz brightness temperature (K)</p></li>
<li><p><strong>tb53</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: 53Ghz brightness temperature (K)</p></li>
<li><p><strong>tb89</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: 89Ghz brightness temperature (K)</p></li>
<li><p><strong>tb23fg</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: 23Ghz brightness temperature from background (K)</p></li>
<li><p><strong>tb31fg</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: 31Ghz brightness temperature from background (K)</p></li>
<li><p><strong>ice</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: sea ice concentration (0-100%)</p></li>
<li><p><strong>tpw</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: total precipitable water (0-70mm)</p></li>
<li><p><strong>rain</strong><em> [</em><em>integer </em><em>,</em><em>out</em><em>]</em> :: rain identification (0=no rain; 1=rain)</p></li>
<li><p><strong>snow</strong><em> [</em><em>integer </em><em>,</em><em>out</em><em>]</em> :: snow cover and glacial ice id: 0=no snow; 1=snow; 2=glacial ice</p></li>
<li><p><strong>scatindexoverlandobs</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: scattering index over land</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsua" title="f/bgckmicrowave_mod/mwbg_tovcheckamsua"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsua()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_r" title="f/obsspacedata_mod/obs_headelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="tovsnl_mod.html#f/tovsnl_mod/tvs_isinstrumallskyttassim" title="f/tovsnl_mod/tvs_isinstrumallskyttassim"><code class="xref f f-func docutils literal notranslate"><span class="pre">tvs_isinstrumallskyttassim()</span></code></a>, <a class="reference internal" href="tovsnl_mod.html#f/tovsnl_mod/tvs_getinstrumentid" title="f/tovsnl_mod/tvs_getinstrumentid"><code class="xref f f-func docutils literal notranslate"><span class="pre">tvs_getinstrumentid()</span></code></a>, <a class="reference internal" href="codtyp_mod.html#f/codtyp_mod/codtyp_get_name" title="f/codtyp_mod/codtyp_get_name"><code class="xref f f-func docutils literal notranslate"><span class="pre">codtyp_get_name()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/bennartz">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">bennartz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tb89</span></em>, <em class="sig-param"><span class="pre">tb150</span></em>, <em class="sig-param"><span class="pre">tb89fg</span></em>, <em class="sig-param"><span class="pre">tb150fg</span></em>, <em class="sig-param"><span class="pre">tb89fgclear</span></em>, <em class="sig-param"><span class="pre">tb150fgclear</span></em>, <em class="sig-param"><span class="pre">scatindexoverlandobs</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/bennartz" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><dl class="simple">
<dt>Compute the following parameters using 2 AMSU-B channels:</dt><dd><ul class="simple">
<li><p>scattering index (over land and ocean).</p></li>
</ul>
</dd>
</dl>
<p>The two channels used are: 89Ghz, 150Ghz.</p>
<p>REGERENCES: Bennartz, R., A. Thoss, A. Dybbroe and D. B. Michelson,
1999: Precipitation Analysis from AMSU, Nowcasting SAF,
Swedish Meteorologicali and Hydrological Institute,
Visiting Scientist Report, November 1999.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>tb89</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tb150</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tb89fg</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tb150fg</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tb89fgclear</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tb150fgclear</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>scatindexoverlandobs</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_r" title="f/obsspacedata_mod/obs_headelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_r()</span></code></a>, <a class="reference internal" href="tovsnl_mod.html#f/tovsnl_mod/tvs_isinstrumallskyttassim" title="f/tovsnl_mod/tvs_isinstrumallskyttassim"><code class="xref f f-func docutils literal notranslate"><span class="pre">tvs_isinstrumallskyttassim()</span></code></a>, <a class="reference internal" href="tovsnl_mod.html#f/tovsnl_mod/tvs_getinstrumentid" title="f/tovsnl_mod/tvs_getinstrumentid"><code class="xref f f-func docutils literal notranslate"><span class="pre">tvs_getinstrumentid()</span></code></a>, <a class="reference internal" href="codtyp_mod.html#f/codtyp_mod/codtyp_get_name" title="f/codtyp_mod/codtyp_get_name"><code class="xref f f-func docutils literal notranslate"><span class="pre">codtyp_get_name()</span></code></a>, <a class="reference internal" href="tovsnl_mod.html#f/tovsnl_mod/tvs_isinstrumallskyhuassim" title="f/tovsnl_mod/tvs_isinstrumallskyhuassim"><code class="xref f f-func docutils literal notranslate"><span class="pre">tvs_isinstrumallskyhuassim()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/atmsmwhs2test1flagbit7check">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">atmsmwhs2test1flagbit7check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">itest</span></em>, <em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">b7chck</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/atmsmwhs2test1flagbit7check" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>test 1: Check flag bit 7 on from the first bgckAtms/bgckMwhs2 program
Includes observations flagged for cloud liquid water, scattering index,
dryness index plus failure of several QC checks.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>itest</strong> (*)<em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: test number</p></li>
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: indicateur du QC par canal</p></li>
<li><p><strong>b7chck</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: bit=7 of channel is on (=1) or off(=0)</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckatms" title="f/bgckmicrowave_mod/mwbg_tovcheckatms"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckatms()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckmwhs2" title="f/bgckmicrowave_mod/mwbg_tovcheckmwhs2"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckmwhs2()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_elem_c" title="f/obsspacedata_mod/obs_elem_c"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_elem_c()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/atmsmwhs2test2topographycheck">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">atmsmwhs2test2topographycheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">itest</span></em>, <em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">modelinterpterrain</span></em>, <em class="sig-param"><span class="pre">ichtopo</span></em>, <em class="sig-param"><span class="pre">zcrit</span></em>, <em class="sig-param"><span class="pre">b7chck</span></em>, <em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/atmsmwhs2test2topographycheck" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>test 2: Topography check (partial)</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>itest</strong> (*)<em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: test number</p></li>
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>modelinterpterrain</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: topo aux point d’obs</p></li>
<li><p><strong>ichtopo</strong> (*)<em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: rejection channel list</p></li>
<li><p><strong>zcrit</strong> (*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: criteria for topo check</p></li>
<li><p><strong>b7chck</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: bit=7 of channel is on (=1) or off(=0)</p></li>
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: indicateur du QC par canal</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckatms" title="f/bgckmicrowave_mod/mwbg_tovcheckatms"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckatms()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckmwhs2" title="f/bgckmicrowave_mod/mwbg_tovcheckmwhs2"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckmwhs2()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_elem_c" title="f/obsspacedata_mod/obs_elem_c"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_elem_c()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/atmsmwhs2test3uncorrectedtbcheck">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">atmsmwhs2test3uncorrectedtbcheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">itest</span></em>, <em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">resetqc</span></em>, <em class="sig-param"><span class="pre">b7chck</span></em>, <em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/atmsmwhs2test3uncorrectedtbcheck" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>Test 3: Uncorrected Tb check (single)
Uncorrected datum (flag bit #6 off).
In this case switch bit 11 ON.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>itest</strong> (*)<em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: test number</p></li>
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>resetqc</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: resetqc logical</p></li>
<li><p><strong>b7chck</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: bit=7 of channel is on (=1) or off(=0)</p></li>
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: indicateur du QC par canal</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckatms" title="f/bgckmicrowave_mod/mwbg_tovcheckatms"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckatms()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckmwhs2" title="f/bgckmicrowave_mod/mwbg_tovcheckmwhs2"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckmwhs2()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_elem_c" title="f/obsspacedata_mod/obs_elem_c"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_elem_c()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/atmstest4roguecheck">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">atmstest4roguecheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">itest</span></em>, <em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">roguefac</span></em>, <em class="sig-param"><span class="pre">waterobs</span></em>, <em class="sig-param"><span class="pre">isfcrej</span></em>, <em class="sig-param"><span class="pre">ich2omprej</span></em>, <em class="sig-param"><span class="pre">b7chck</span></em>, <em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/atmstest4roguecheck" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>test 4: “Rogue check” for (O-P) Tb residuals out of range (single/full).
Also, over WATER remove CH.17-22 if CH.17 <a href="#id11"><span class="problematic" id="id12">|O-P|</span></a>&gt;5K (partial)
Les observations, dont le residu (O-P)
depasse par un facteur (roguefac) l’erreur totale des TOVS.</p>
<p>N.B.: a reject by any of the 3 amsua surface channels 1-3 produces the
rejection of ATMS sfc/tropospheric channels 1-6 and 16-17.</p>
<p>OVER OPEN WATER ch. 17 Abs(O-P) &gt; 5K produces rejection of all ATMS amsub channels 17-22.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>itest</strong> (*)<em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: test number</p></li>
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>roguefac</strong> (*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: rogue factor</p></li>
<li><p><strong>waterobs</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: open water obs</p></li>
<li><p><strong>isfcrej</strong> (*)<em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: rejection surface channel list</p></li>
<li><p><strong>ich2omprej</strong> (*)<em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: rejection channel list</p></li>
<li><p><strong>b7chck</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: bit=7 of channel is on (=1) or off(=0)</p></li>
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: indicateur du QC par canal</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckatms" title="f/bgckmicrowave_mod/mwbg_tovcheckatms"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckatms()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_r" title="f/obsspacedata_mod/obs_headelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_elem_c" title="f/obsspacedata_mod/obs_elem_c"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_elem_c()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/calcstatedepobserr" title="f/bgckmicrowave_mod/calcstatedepobserr"><code class="xref f f-func docutils literal notranslate"><span class="pre">calcstatedepobserr()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/mwhs2test4roguecheck">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">mwhs2test4roguecheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">itest</span></em>, <em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">roguefac</span></em>, <em class="sig-param"><span class="pre">waterobs</span></em>, <em class="sig-param"><span class="pre">ich2omprej</span></em>, <em class="sig-param"><span class="pre">b7chck</span></em>, <em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/mwhs2test4roguecheck" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>test 4: “Rogue check” for (O-P) Tb residuals out of range (single/full).
Also, over WATER remove CH.10-15 if CH.10 <a href="#id13"><span class="problematic" id="id14">|O-P|</span></a>&gt;5K (full)
Les observations, dont le residu (O-P)
depasse par un facteur (roguefac) l’erreur totale des TOVS.</p>
<p>OVER OPEN WATER ch. 10 Abs(O-P) &gt; 5K produces rejection of all ATMS amsub channels 10-15.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>itest</strong> (*)<em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: test number</p></li>
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>roguefac</strong> (*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: rogue factor</p></li>
<li><p><strong>waterobs</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: open water obs</p></li>
<li><p><strong>ich2omprej</strong> (*)<em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: rejection channel list</p></li>
<li><p><strong>b7chck</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: bit=7 of channel is on (=1) or off(=0)</p></li>
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: indicateur du QC par canal</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckmwhs2" title="f/bgckmicrowave_mod/mwbg_tovcheckmwhs2"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckmwhs2()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_r" title="f/obsspacedata_mod/obs_headelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_elem_c" title="f/obsspacedata_mod/obs_elem_c"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_elem_c()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/calcstatedepobserr" title="f/bgckmicrowave_mod/calcstatedepobserr"><code class="xref f f-func docutils literal notranslate"><span class="pre">calcstatedepobserr()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/atmsmwhs2test5channelselectionusingtovutil">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">atmsmwhs2test5channelselectionusingtovutil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">itest</span></em>, <em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/atmsmwhs2test5channelselectionusingtovutil" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>test 5: Channel selection using array oer_tovutil(chan,sat):
- = 0 blacklisted,
- = 1 assmilate</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>itest</strong> (*)<em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: test number</p></li>
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckatms" title="f/bgckmicrowave_mod/mwbg_tovcheckatms"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckatms()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckmwhs2" title="f/bgckmicrowave_mod/mwbg_tovcheckmwhs2"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckmwhs2()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_elem_c" title="f/obsspacedata_mod/obs_elem_c"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_elem_c()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/mwbg_tovcheckatms">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">mwbg_tovcheckatms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">modelinterpterrain</span></em>, <em class="sig-param"><span class="pre">resetqc</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/mwbg_tovcheckatms" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>Effectuer le controle de qualite des radiances tovs.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>out,allocatable</em><em>]</em> :: indicateur controle de qualite tovs par canal (=0 ok, &gt;0 rejet)</p></li>
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>modelinterpterrain</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: topographie du modele</p></li>
<li><p><strong>resetqc</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: reset du controle de qualite?</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_bgcheckmw" title="f/bgckmicrowave_mod/mwbg_bgcheckmw"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_bgcheckmw()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/atmsmwhs2landicemask" title="f/bgckmicrowave_mod/atmsmwhs2landicemask"><code class="xref f f-func docutils literal notranslate"><span class="pre">atmsmwhs2landicemask()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_grossvaluecheck" title="f/bgckmicrowave_mod/mwbg_grossvaluecheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_grossvaluecheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_firstqccheckatms" title="f/bgckmicrowave_mod/mwbg_firstqccheckatms"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_firstqccheckatms()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_nrlfilteratms" title="f/bgckmicrowave_mod/mwbg_nrlfilteratms"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_nrlfilteratms()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_flagdatausingnrlcritatms" title="f/bgckmicrowave_mod/mwbg_flagdatausingnrlcritatms"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_flagdatausingnrlcritatms()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_reviewallcritforfinalflagsatms" title="f/bgckmicrowave_mod/mwbg_reviewallcritforfinalflagsatms"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_reviewallcritforfinalflagsatms()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/atmsmwhs2test1flagbit7check" title="f/bgckmicrowave_mod/atmsmwhs2test1flagbit7check"><code class="xref f f-func docutils literal notranslate"><span class="pre">atmsmwhs2test1flagbit7check()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/atmsmwhs2test2topographycheck" title="f/bgckmicrowave_mod/atmsmwhs2test2topographycheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">atmsmwhs2test2topographycheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/atmsmwhs2test3uncorrectedtbcheck" title="f/bgckmicrowave_mod/atmsmwhs2test3uncorrectedtbcheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">atmsmwhs2test3uncorrectedtbcheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/atmstest4roguecheck" title="f/bgckmicrowave_mod/atmstest4roguecheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">atmstest4roguecheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/atmsmwhs2test5channelselectionusingtovutil" title="f/bgckmicrowave_mod/atmsmwhs2test5channelselectionusingtovutil"><code class="xref f f-func docutils literal notranslate"><span class="pre">atmsmwhs2test5channelselectionusingtovutil()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/resetqccases" title="f/bgckmicrowave_mod/resetqccases"><code class="xref f f-func docutils literal notranslate"><span class="pre">resetqccases()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/mwbg_tovcheckmwhs2">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">mwbg_tovcheckmwhs2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">qcindicator</span></em>, <em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">modelinterpterrain</span></em>, <em class="sig-param"><span class="pre">resetqc</span></em>, <em class="sig-param"><span class="pre">modlsq</span></em>, <em class="sig-param"><span class="pre">lastheader</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/mwbg_tovcheckmwhs2" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>Effectuer le controle de qualite des radiances tovs.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>qcindicator</strong> (*)<em> [</em><em>integer </em><em>,</em><em>out,allocatable</em><em>]</em> :: indicateur controle de qualite tovs par canal (=0 ok, &gt;0 rejet)</p></li>
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>modelinterpterrain</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: topographie du modele as being over land/ice, cloudy, bad IWV</p></li>
<li><p><strong>resetqc</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: reset du controle de qualite?</p></li>
<li><p><strong>modlsq</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: If active, recalculate land/sea qualifier and terrain type based on LG/MG</p></li>
<li><p><strong>lastheader</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: active if last header</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_bgcheckmw" title="f/bgckmicrowave_mod/mwbg_bgcheckmw"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_bgcheckmw()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/atmsmwhs2landicemask" title="f/bgckmicrowave_mod/atmsmwhs2landicemask"><code class="xref f f-func docutils literal notranslate"><span class="pre">atmsmwhs2landicemask()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_grossvaluecheck" title="f/bgckmicrowave_mod/mwbg_grossvaluecheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_grossvaluecheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_firstqccheckmwhs2" title="f/bgckmicrowave_mod/mwbg_firstqccheckmwhs2"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_firstqccheckmwhs2()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_nrlfiltermwhs2" title="f/bgckmicrowave_mod/mwbg_nrlfiltermwhs2"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_nrlfiltermwhs2()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_flagdatausingnrlcritmwhs2" title="f/bgckmicrowave_mod/mwbg_flagdatausingnrlcritmwhs2"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_flagdatausingnrlcritmwhs2()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_reviewallcritforfinalflagsmwhs2" title="f/bgckmicrowave_mod/mwbg_reviewallcritforfinalflagsmwhs2"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_reviewallcritforfinalflagsmwhs2()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/atmsmwhs2test1flagbit7check" title="f/bgckmicrowave_mod/atmsmwhs2test1flagbit7check"><code class="xref f f-func docutils literal notranslate"><span class="pre">atmsmwhs2test1flagbit7check()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/atmsmwhs2test2topographycheck" title="f/bgckmicrowave_mod/atmsmwhs2test2topographycheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">atmsmwhs2test2topographycheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/atmsmwhs2test3uncorrectedtbcheck" title="f/bgckmicrowave_mod/atmsmwhs2test3uncorrectedtbcheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">atmsmwhs2test3uncorrectedtbcheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwhs2test4roguecheck" title="f/bgckmicrowave_mod/mwhs2test4roguecheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwhs2test4roguecheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/atmsmwhs2test5channelselectionusingtovutil" title="f/bgckmicrowave_mod/atmsmwhs2test5channelselectionusingtovutil"><code class="xref f f-func docutils literal notranslate"><span class="pre">atmsmwhs2test5channelselectionusingtovutil()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/resetqccases" title="f/bgckmicrowave_mod/resetqccases"><code class="xref f f-func docutils literal notranslate"><span class="pre">resetqccases()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/mwbg_readgeophysicfieldsandinterpolate">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">mwbg_readgeophysicfieldsandinterpolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">instname</span></em>, <em class="sig-param"><span class="pre">modelinterpterrain</span></em>, <em class="sig-param"><span class="pre">modelinterplandfrac</span></em>, <em class="sig-param"><span class="pre">modelinterpseaice</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/mwbg_readgeophysicfieldsandinterpolate" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>Reads Modele Geophysical variables and save for the first time
TOPOGRAPHIE (MF ou MX):</p>
<blockquote>
<div><ul class="simple">
<li><p>MF est la topographie filtree avec unites en metres (filtered ME).</p></li>
<li><p>MX est la topographie filtree avec unites en m2/s2  (geopotential topography).</p></li>
<li><p>Glace de Mer (GL)</p></li>
<li><p>Masque Terre-Mer (MG)</p></li>
</ul>
</div></blockquote>
<p>Then Interpolate Those variables to observation location</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>instname</strong><em> [</em><em>character </em><em>,</em><em>in</em><em>]</em> :: Instrument Name</p></li>
<li><p><strong>modelinterpterrain</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: topographie filtree (en metres) et interpolees</p></li>
<li><p><strong>modelinterplandfrac</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: model interpolated land fraction.</p></li>
<li><p><strong>modelinterpseaice</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: Glace de mer interpolees au pt d’obs.</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_bgcheckmw" title="f/bgckmicrowave_mod/mwbg_bgcheckmw"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_bgcheckmw()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_r" title="f/obsspacedata_mod/obs_headelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_r()</span></code></a>, <a class="reference internal" href="utilities_mod.html#f/utilities_mod/utl_abort" title="f/utilities_mod/utl_abort"><code class="xref f f-func docutils literal notranslate"><span class="pre">utl_abort()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/atmsmwhs2landicemask">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">atmsmwhs2landicemask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">calclandqualifierindice</span></em>, <em class="sig-param"><span class="pre">calcterraintypeindice</span></em>, <em class="sig-param"><span class="pre">waterobs</span></em>, <em class="sig-param"><span class="pre">ilsmopt</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/atmsmwhs2landicemask" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>This routine sets waterobs array by performing a land/ice proximity check using
using analysis MG and LG (or GL) fields used by the model which produces the trial field.
The purpose of this check is to remove obs that reside close to coasts or ice,
and so whose TBs may be contaminated.
The GEM Global (glbhyb2) analysis contains MG and LG fields (on different grids).
Adapted from: land_ice_mask_ssmis.ftn90 of mwbg_ssmis (D. Anselmo, S. Macpherson)</p>
<p>NOTE: The 0.1 deg binary ice field check from land_ice_mask_ssmis.ftn90
was removed. The land/sea qualifier (calcLandQualifierIndice) and terrain type (calcTerrainTypeIndice)
are modified to indicate proximity to land and sea-ice but are NOT changed in output BURP file.</p>
<p>In the application of this check, a 5x5 mesh, with spacing defined by rlat_km and
rlon_km, is positioned with its center over an obs pt (2 grid pts on either side
of the obs pt; size of mesh is equal to 4*rlat_km x 4*rlon_km). The values of MG
and LG are evaluated at the grid points of this mesh. For ilsmOpt=1 (or 3), the maximum
(or average) determines whether the obs pt is too close to ice or land to be retained.
For ilsmOpt=2, the value at the central mesh point is used.
<a href="#id5"><span class="problematic" id="id6">**</span></a>NOTE: the threshold value for MG has a very strong effect on the distance</p>
<blockquote>
<div><p>from land that is permitted for an obs to be retained</p>
</div></blockquote>
<dl>
<dt>Maximum FOV             x—x—x—x—x     ^</dt><dd><p>= 75km x 75km        |   |   |   |   |     |
for Meso-sphere CHs  x—x—x—x—x     |
= 74km x 47km        |   |   |   |   |     |
for 19 GHz           x—x—o—x—x     | = 4*rlat_km</p>
<blockquote>
<div><blockquote>
<div><blockquote>
<div><div class="line-block">
<div class="line">|   |   |   |     | = 4*40 km</div>
</div>
</div></blockquote>
<p>^  x—x—x—x—x     | = 160 km = 80 km north &amp; south</p>
</div></blockquote>
<dl>
<dt>rlat_km |  |   |   |   |   |     |</dt><dd><dl>
<dt>v  x—x—x—x—x     v</dt><dd><blockquote>
<div><blockquote>
<div><p>&lt;—&gt;</p>
</div></blockquote>
<p>rlon_km</p>
</div></blockquote>
<dl class="simple">
<dt>&lt;—————&gt;</dt><dd><p>= 4*rlon_km
= 4*40 km
= 160 km = 80 km east &amp; west</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
</dd>
</dl>
<p>MG value = 1.0  ==&gt;  LAND       MG value = 0.0  ==&gt;  OCEAN
LG value = 1.0  ==&gt;  ICE        LG value = 0.0  ==&gt;  NO ICE</p>
<ul class="simple">
<li><p>mxlat      : internal-  number of grid pts in lat. direction for mesh</p></li>
<li><p>mxlon      : internal-  number of grid pts in lon. direction for mesh</p></li>
<li><dl class="simple">
<dt>rlat_km<span class="classifier">internal-  spacing desired between mesh grid points in km</span></dt><dd><p>along lat. direction</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>rlon_km<span class="classifier">internal-  spacing desired between mesh grid points in km</span></dt><dd><p>along lon. direction</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>dlat<span class="classifier">internal-  spacing between mesh grid points along lon. direction</span></dt><dd><p>in degrees computed from rlat_km</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>dlon<span class="classifier">internal-  spacing between mesh grid points along lon. direction</span></dt><dd><p>in degrees computed from rlon_km</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>rkm_per_deg<span class="classifier">internal- distance in km per degree</span></dt><dd><p>= Earth radius * PI/180.0
= 6371.01 km * PI/180.0
= 111.195 km</p>
</dd>
</dl>
</li>
<li><p>nlat,nlon  : internal-  used to define the lat/lon of the grid pts of mesh</p></li>
<li><p>zlatbox    : internal-  lat values at all grid pts of mesh for all obs pts</p></li>
<li><p>zlonbox    : internal-  lon values at all grid pts of mesh for all obs pts</p></li>
<li><p>latmesh    : internal-  lat values at all grid pts of mesh for 1 obs pt</p></li>
<li><p>lonmesh    : internal-  lon values at all grid pts of mesh for 1 obs pt</p></li>
<li><p>mgintob    : internal-  interpolated MG values at all grid pts of mesh for 1 obs pt</p></li>
<li><p>lgintob    : internal-  interpolated LG values at all grid pts of mesh for 1 obs pt</p></li>
<li><p>mgintrp    : internal-  max. interpolated MG value on mesh for all obs pts</p></li>
<li><p>lgintrp    : internal-  max. interpolated LG value on mesh for all obs pts</p></li>
<li><p>MGthresh   : internal-  maximum allowable land fraction for obs to be kept</p></li>
<li><p>LGthresh   : internal-  maximum allowable ice  fraction for obs to be kept</p></li>
</ul>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>calclandqualifierindice</strong><em> [</em><em>integer </em><em>,</em><em>out</em><em>]</em> :: land/sea qualifier (0 = land, 1 = sea)</p></li>
<li><p><strong>calcterraintypeindice</strong><em> [</em><em>integer </em><em>,</em><em>out</em><em>]</em> :: terrain-type (-1 land/open water, 0 = ice)</p></li>
<li><p><strong>waterobs</strong><em> [</em><em>logical </em><em>,</em><em>out</em><em>]</em> :: if obs over open water, far from coast/ice</p></li>
<li><p><strong>ilsmopt</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: option for “interpolated” value of MG, LG at each location, 1 = use MAX value taken from all mesh grid points, 2 = use CENTRAL mesh point value (value at obs location), 3 = use AVG value of all mesh grid points</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckatms" title="f/bgckmicrowave_mod/mwbg_tovcheckatms"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckatms()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckmwhs2" title="f/bgckmicrowave_mod/mwbg_tovcheckmwhs2"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckmwhs2()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_computemwhs2surfacetype" title="f/bgckmicrowave_mod/mwbg_computemwhs2surfacetype"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_computemwhs2surfacetype()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_r" title="f/obsspacedata_mod/obs_headelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_r()</span></code></a>, <a class="reference internal" href="utilities_mod.html#f/utilities_mod/utl_abort" title="f/utilities_mod/utl_abort"><code class="xref f f-func docutils literal notranslate"><span class="pre">utl_abort()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/mwbg_computemwhs2surfacetype">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">mwbg_computemwhs2surfacetype</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/mwbg_computemwhs2surfacetype" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>Compute surface type element and update obsSpaceData.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: ObsSpaceData object</p>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="../programs/midas_obsSelection.html#f/midas_obsselection" title="f/midas_obsselection"><code class="xref f f-prog docutils literal notranslate"><span class="pre">midas_obsselection</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_getheaderindex" title="f/obsspacedata_mod/obs_getheaderindex"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_getheaderindex()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="tovsnl_mod.html#f/tovsnl_mod/tvs_isidburpinst" title="f/tovsnl_mod/tvs_isidburpinst"><code class="xref f f-func docutils literal notranslate"><span class="pre">tvs_isidburpinst()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_init" title="f/bgckmicrowave_mod/mwbg_init"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_init()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/atmsmwhs2landicemask" title="f/bgckmicrowave_mod/atmsmwhs2landicemask"><code class="xref f f-func docutils literal notranslate"><span class="pre">atmsmwhs2landicemask()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headset_i" title="f/obsspacedata_mod/obs_headset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/mwbg_grossvaluecheck">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">mwbg_grossvaluecheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">ztbthresholdmin</span></em>, <em class="sig-param"><span class="pre">ztbthresholdmax</span></em>, <em class="sig-param"><span class="pre">grossrej</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/mwbg_grossvaluecheck" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>Check Tbs for values that are missing or outside physical limits.
REJECT ALL CHANNELS OF ONE IS FOUND TO BE BAD.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ztbthresholdmin</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: ztb threshold for rejection</p></li>
<li><p><strong>ztbthresholdmax</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: ztb threshold for rejection</p></li>
<li><p><strong>grossrej</strong><em> [</em><em>logical </em><em>,</em><em>out</em><em>]</em> :: logical array defining which obs are to be rejected</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckatms" title="f/bgckmicrowave_mod/mwbg_tovcheckatms"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckatms()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckmwhs2" title="f/bgckmicrowave_mod/mwbg_tovcheckmwhs2"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckmwhs2()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/mwbg_firstqccheckatms">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">mwbg_firstqccheckatms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">qcrejectlogic</span></em>, <em class="sig-param"><span class="pre">grossrej</span></em>, <em class="sig-param"><span class="pre">calclandqualifierindice</span></em>, <em class="sig-param"><span class="pre">calcterraintypeindice</span></em>, <em class="sig-param"><span class="pre">reporthasmissingtb</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/mwbg_firstqccheckatms" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>This routine performs basic quality control checks on the data. It sets array
qcRejectLogic(actualNumChannel) elements to .true. to flag data with failed checks.</p>
<dl class="simple">
<dt>The 6 QC checks are:</dt><dd><ul class="simple">
<li><ol class="arabic simple">
<li><p>Invalid land/sea qualifier or terrain type,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="2">
<li><p>Invalid field of view number,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="3">
<li><p>Satellite zenith angle missing or out of range, (&gt; 75 deg),</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="4">
<li><p>lat,lon check (lat,lon = O(-90.), 0(-180.))</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="5">
<li><p>Change in (computed) calcLandQualifierIndice,calcTerrainTypeIndice from (input)</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="6">
<li><p>ATMS quality flag check (qual. flag elements 33078,33079,33080,33081)</p></li>
</ol>
</li>
</ul>
</dd>
</dl>
<p>landQualifierIndice,terrainTypeIndice (from MG,LG fields).</p>
<p>landQualifierIndice= 0,1 (from hi-res land/sea mask interpolated to obs point [CMDA])</p>
<p>terrainTypeIndice=-1,0 (from hi-res ice analysis  interpolated to obs point [CMDA])</p>
<p>calcLandQualifierIndice= 0,1 (from max interp MG (0.0 to 1.0) in box surrounding obs point)</p>
<p>calcTerrainTypeIndice=-1,0 (from max interp LG (0.0 to 1.0) in box surrounding obs point)</p>
<p>In most cases, qcRejectLogic(actualNumChannel) is set to .true. for all channels at point ii
if the check detects a problem. In addition, Tb (obsTb) is set to missing_value
for checks 3 and 4 fails.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>qcrejectlogic</strong> (*)<em> [</em><em>logical </em><em>,</em><em>out,allocatable</em><em>]</em> :: qcRejectLogic = .false. on input</p></li>
<li><p><strong>grossrej</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: <p>’</p>
</p></li>
<li><p><strong>calclandqualifierindice</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: land/sea qualifier (0 = land, 1 = sea)</p></li>
<li><p><strong>calcterraintypeindice</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: terrain-type (-1 land/open water, 0 = ice)</p></li>
<li><p><strong>reporthasmissingtb</strong><em> [</em><em>logical </em><em>,</em><em>out</em><em>]</em> :: .true. if Tb(obsTb) are set to missing_value</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckatms" title="f/bgckmicrowave_mod/mwbg_tovcheckatms"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckatms()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_r" title="f/obsspacedata_mod/obs_headelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/mwbg_firstqccheckmwhs2">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">mwbg_firstqccheckmwhs2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">qcrejectlogic</span></em>, <em class="sig-param"><span class="pre">calclandqualifierindice</span></em>, <em class="sig-param"><span class="pre">calcterraintypeindice</span></em>, <em class="sig-param"><span class="pre">reporthasmissingtb</span></em>, <em class="sig-param"><span class="pre">modlsq</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/mwbg_firstqccheckmwhs2" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>This routine performs basic quality control checks on the data. It sets array
qcRejectLogic(actualNumChannel) elements to .true. to flag data with failed checks. Check 1
(for landQualifierIndice,terrainTypeIndice) and check 5 are skipped if modlsqtt=.true.,
as the original values will be replaced in output file by calcLandQualifierIndice,calcTerrainTypeIndice.</p>
<dl class="simple">
<dt>The 5 QC checks are:</dt><dd><ul class="simple">
<li><ol class="arabic simple">
<li><p>Invalid land/sea qualifier or terrain type,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="2">
<li><p>Invalid field of view number,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="3">
<li><p>Satellite zenith angle missing or out of range, (&gt; 75 deg),</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="4">
<li><p>lat,lon check (lat,lon = O(-90.), 0(-180.))</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="5">
<li><p>Change in (computed) calcLandQualifierIndice,calcTerrainTypeIndice</p></li>
</ol>
</li>
</ul>
</dd>
</dl>
<p>from (input) landQualifierIndice,terrainTypeIndice (from MG,LG fields).</p>
<p>landQualifierIndice= 0,1 (from hi-res land/sea mask interpolated to obs point [CMDA])</p>
<p>terrainTypeIndice=-1,0 (from hi-res ice analysis  interpolated to obs point [CMDA])</p>
<p>calcLandQualifierIndice= 0,1 (from max interp MG (0.0 to 1.0) in box surrounding obs point)</p>
<p>calcTerrainTypeIndice=-1,0 (from max interp LG (0.0 to 1.0) in box surrounding obs point)</p>
<p>In most cases, qcRejectLogic(ii,actualNumChannel) is set to .true. for all channels at point ii
if the check detects a problem. In addition, Tb (obsTb) is set to missing_value
for checks 3 and 4 fails.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>qcrejectlogic</strong> (*)<em> [</em><em>logical </em><em>,</em><em>inout,allocatable</em><em>]</em> :: qcRejectLogic = .false. on input</p></li>
<li><p><strong>calclandqualifierindice</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: land/sea qualifier (0 = land, 1 = sea)</p></li>
<li><p><strong>calcterraintypeindice</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: terrain-type (-1 land/open water, 0 = ice)</p></li>
<li><p><strong>reporthasmissingtb</strong><em> [</em><em>logical </em><em>,</em><em>out</em><em>]</em> :: true if Tb(obsTb) are set to missing_value</p></li>
<li><p><strong>modlsq</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: If active, recalculate land/sea qualifier and terrain type based on LG/MG</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckmwhs2" title="f/bgckmicrowave_mod/mwbg_tovcheckmwhs2"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckmwhs2()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_r" title="f/obsspacedata_mod/obs_headelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_r()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/mwbg_nrlfilteratms">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">mwbg_nrlfilteratms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">calclandqualifierindice</span></em>, <em class="sig-param"><span class="pre">calcterraintypeindice</span></em>, <em class="sig-param"><span class="pre">waterobs</span></em>, <em class="sig-param"><span class="pre">grossrej</span></em>, <em class="sig-param"><span class="pre">si_ecmwf</span></em>, <em class="sig-param"><span class="pre">si_bg</span></em>, <em class="sig-param"><span class="pre">inumseaice</span></em>, <em class="sig-param"><span class="pre">irej</span></em>, <em class="sig-param"><span class="pre">seaice</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/mwbg_nrlfilteratms" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><dl class="simple">
<dt>Compute the following parameters using 5 ATMS channels:</dt><dd><ul class="simple">
<li><p>sea ice,</p></li>
<li><p>cloud liquid water from observation (cloudLiquidWaterPathObs),</p></li>
<li><p>cloud liquid water from first guess (cloudLiquidWaterPathFG),</p></li>
<li><p>2 scattering indices (si) (ECMWF, Bennartz-Grody)</p></li>
</ul>
</dd>
</dl>
<p>The five channels used are: 23Ghz, 31Ghz, 50Ghz, 89Ghz, and 165Ghz.</p>
<dl class="simple">
<dt>NOTES:</dt><dd><ul class="simple">
<li><p>open water points are converted to sea-ice points if sea ice concentration &gt;= 0.55
and &lt;calcTerrainTypeIndice&gt; (terrainTypeIndice or terrain type) is changed accordingly</p></li>
<li><p>&lt;cloudLiquidWaterPathObs&gt; are missing when out-of-range parameters/Tb detected or grossrej = .true.</p></li>
<li><p>&lt;cloudLiquidWaterPathObs&gt; and si only computed over open water away from coasts and sea-ice</p></li>
<li><p>&lt;cloudLiquidWaterPathObs&gt; and si = mwbg_realMissing where value cannot be computed.</p></li>
</ul>
</dd>
</dl>
<p>REFERENCES: Ben Ruston, NRL Monterey
JCSDA Seminar 12/12/12: Impact of NPP Satellite Assimilation in the U.S. Navy Global Modeling System</p>
<p>Notes: In the case where an output parameter cannot be calculated, the
value of this parameter is set to mwbg_realMissing</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>calclandqualifierindice</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: land/sea indicator (0=land, 1=ocean)</p></li>
<li><p><strong>calcterraintypeindice</strong><em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: terrain type (0=ice, -1 otherwise)</p></li>
<li><p><strong>waterobs</strong><em> [</em><em>logical </em><em>,</em><em>inout</em><em>]</em> :: .true. if open water point (away from coasts and sea-ice)</p></li>
<li><p><strong>grossrej</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: .true. if any channel had a gross error from mwbg_grossValueCheck</p></li>
<li><p><strong>si_ecmwf</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>si_bg</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: Bennartz-Grody scattering index from tb89 &amp; tb165</p></li>
<li><p><strong>inumseaice</strong><em> [</em><em>integer </em><em>,</em><em>out</em><em>]</em> :: counter for number open water points with sea-ice detected (from algorithm)</p></li>
<li><p><strong>irej</strong><em> [</em><em>integer </em><em>,</em><em>out</em><em>]</em> :: counter for number locations with bad satZenithAngle, obsLat, calcLandQualifierIndice, or with grossrej=true</p></li>
<li><p><strong>seaice</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckatms" title="f/bgckmicrowave_mod/mwbg_tovcheckatms"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckatms()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_r" title="f/obsspacedata_mod/obs_headelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/mwbg_nrlfiltermwhs2">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">mwbg_nrlfiltermwhs2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">calclandqualifierindice</span></em>, <em class="sig-param"><span class="pre">calcterraintypeindice</span></em>, <em class="sig-param"><span class="pre">waterobs</span></em>, <em class="sig-param"><span class="pre">grossrej</span></em>, <em class="sig-param"><span class="pre">si_ecmwf</span></em>, <em class="sig-param"><span class="pre">si_bg</span></em>, <em class="sig-param"><span class="pre">inumseaice</span></em>, <em class="sig-param"><span class="pre">irej</span></em>, <em class="sig-param"><span class="pre">seaice</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/mwbg_nrlfiltermwhs2" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><dl class="simple">
<dt>Compute the following parameters using 2 MWHS2 channels:</dt><dd><ul class="simple">
<li><p>sea ice,</p></li>
<li><p>cloud liquid water from observation (cloudLiquidWaterPathObs),</p></li>
<li><p>cloud liquid water from first guess (cloudLiquidWaterPathFG),</p></li>
<li><p>2 scattering indices (si) (ECMWF, Bennartz-Grody)</p></li>
</ul>
</dd>
</dl>
<p>The two channels used are: 89Ghz, and 165Ghz.</p>
<dl class="simple">
<dt>NOTES:</dt><dd><ul class="simple">
<li><p>open water points are converted to sea-ice points if sea ice concentration &gt;= 0.55
and calcTerrainTypeIndice (terrainTypeIndice or terrain type) is changed accordingly</p></li>
<li><p>&lt;cloudLiquidWaterPathObs&gt; are missing when out-of-range parameters/Tb detected or grossrej = .true.</p></li>
<li><p>&lt;cloudLiquidWaterPathObs&gt; and &lt;si_ecmwf&gt; only computed over open water away from coasts and sea-ice</p></li>
<li><p>&lt;si_bg&gt; is computed for all points</p></li>
<li><p>&lt;cloudLiquidWaterPathObs&gt; and si = mwbg_realMissing where value cannot be computed.</p></li>
</ul>
</dd>
</dl>
<p>REFERENCES: Ben Ruston, NRL Monterey
JCSDA Seminar 12/12/12: Impact of NPP Satellite Assimilation in the U.S. Navy Global Modeling System</p>
<p>Notes: In the case where an output parameter cannot be calculated, the
value of this parameter is set to mwbg_realMissing</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>calclandqualifierindice</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: land/sea indicator (0=land, 1=ocean)</p></li>
<li><p><strong>calcterraintypeindice</strong><em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: terrain type (0=ice, -1 otherwise)</p></li>
<li><p><strong>waterobs</strong><em> [</em><em>logical </em><em>,</em><em>inout</em><em>]</em> :: .true. if open water point (away from coasts and sea-ice)</p></li>
<li><p><strong>grossrej</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: .true. if any channel had a gross error from mwbg_grossValueCheck</p></li>
<li><p><strong>si_ecmwf</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>si_bg</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: Bennartz-Grody scattering index from tb89 &amp; tb165</p></li>
<li><p><strong>inumseaice</strong><em> [</em><em>integer </em><em>,</em><em>out</em><em>]</em> :: running counter for number of open water points with sea-ice detected (from algorithm)</p></li>
<li><p><strong>irej</strong><em> [</em><em>integer </em><em>,</em><em>out</em><em>]</em> :: running counter for number of locations with bad satZenithAngle, obsLat, calcLandQualifierIndice, or with grossrej=true</p></li>
<li><p><strong>seaice</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckmwhs2" title="f/bgckmicrowave_mod/mwbg_tovcheckmwhs2"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckmwhs2()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_r" title="f/obsspacedata_mod/obs_headelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/mwbg_flagdatausingnrlcritatms">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">mwbg_flagdatausingnrlcritatms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">scatec</span></em>, <em class="sig-param"><span class="pre">scatbg</span></em>, <em class="sig-param"><span class="pre">seaice</span></em>, <em class="sig-param"><span class="pre">grossrej</span></em>, <em class="sig-param"><span class="pre">waterobs</span></em>, <em class="sig-param"><span class="pre">useunbiasedobsforclw</span></em>, <em class="sig-param"><span class="pre">iwvreject</span></em>, <em class="sig-param"><span class="pre">cloudobs</span></em>, <em class="sig-param"><span class="pre">precipobs</span></em>, <em class="sig-param"><span class="pre">cldcnt</span></em>, <em class="sig-param"><span class="pre">riwv</span></em>, <em class="sig-param"><span class="pre">zdi</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/mwbg_flagdatausingnrlcritatms" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>Set the Information flag (newInformationFlag) values (new BURP element 025174 in header).
BIT Meaning:</p>
<blockquote>
<div><ul class="simple">
<li><p>0     off=land or sea-ice, on=open water away from coast</p></li>
<li><p>1     Mean 183 Ghz [ch. 18-22] is missing</p></li>
<li><p>2     CLW is missing (over water)</p></li>
<li><p>3     CLW &gt; clw_atms_nrl_LTrej (0.175 kg/m2) (cloudobs)</p></li>
<li><p>4     scatec/scatbg &gt; Lower Troposphere limit 9/10 (precipobs)</p></li>
<li><p>5     Mean 183 Ghz [ch. 18-22] Tb &lt; 240K</p></li>
<li><p>6     CLW &gt; clw_atms_nrl_UTrej (0.200 kg/m2)</p></li>
<li><p>7     Dryness Index rejection (for ch. 22)</p></li>
<li><p>8     scatec/scatbg &gt; Upper Troposphere limit 18/15</p></li>
<li><p>9     Dryness Index rejection (for ch. 21)</p></li>
<li><p>10     Sea ice &gt; 0.55 detected</p></li>
<li><p>11     Gross error in Tb (any chan.) (all channels rejected)</p></li>
</ul>
</div></blockquote>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>scatec</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>scatbg</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: Bennartz-Grody scattering index from tb89 &amp; tb165</p></li>
<li><p><strong>seaice</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>grossrej</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: .true. if any channel had a gross error from mwbg_grossValueCheck</p></li>
<li><p><strong>waterobs</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: if obs over open-water</p></li>
<li><p><strong>useunbiasedobsforclw</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: use unbiased Tb for CLW calculation</p></li>
<li><p><strong>iwvreject</strong><em> [</em><em>logical </em><em>,</em><em>out</em><em>]</em> :: .true. if Mean 183 Ghz [ch. 18-22] Tb &lt; 240K (too dry for ch.20-22 over land)</p></li>
<li><p><strong>cloudobs</strong><em> [</em><em>logical </em><em>,</em><em>out</em><em>]</em> :: .true. if CLW &gt; clw_atms_nrl_LTrej (0.175) or precipobs</p></li>
<li><p><strong>precipobs</strong><em> [</em><em>logical </em><em>,</em><em>out</em><em>]</em> :: .true. if precip. detected through NRL scattering indices</p></li>
<li><p><strong>cldcnt</strong><em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: Number of water point covered by cloud</p></li>
<li><p><strong>riwv</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: Mean 183 Ghz [ch. 18-22] Tb</p></li>
<li><p><strong>zdi</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: simple AMSU-B Dryness Index Tb(ch.3)-Tb(ch.5)</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckatms" title="f/bgckmicrowave_mod/mwbg_tovcheckatms"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckatms()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_r" title="f/obsspacedata_mod/obs_headelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headset_i" title="f/obsspacedata_mod/obs_headset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/mwbg_flagdatausingnrlcritmwhs2">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">mwbg_flagdatausingnrlcritmwhs2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">scatec</span></em>, <em class="sig-param"><span class="pre">seaice</span></em>, <em class="sig-param"><span class="pre">grossrej</span></em>, <em class="sig-param"><span class="pre">waterobs</span></em>, <em class="sig-param"><span class="pre">useunbiasedobsforclw</span></em>, <em class="sig-param"><span class="pre">iwvreject</span></em>, <em class="sig-param"><span class="pre">cloudobs</span></em>, <em class="sig-param"><span class="pre">precipobs</span></em>, <em class="sig-param"><span class="pre">cldcnt</span></em>, <em class="sig-param"><span class="pre">riwv</span></em>, <em class="sig-param"><span class="pre">zdi</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/mwbg_flagdatausingnrlcritmwhs2" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>Set the  Information flag (newInformationFlag) values (new BURP element 025174 in header).
BIT Meaning:</p>
<blockquote>
<div><ul class="simple">
<li><p>0     off=land or sea-ice, on=open water away from coast</p></li>
<li><p>1     Mean 183 Ghz [ch. 18-22] is missing</p></li>
<li><p>2     CLW is missing (over water)</p></li>
<li><p>3     CLW &gt; clw_mwhs2_nrl_LTrej (0.175 kg/m2) (cloudobs)</p></li>
<li><p>4     scatec &gt; Lower Troposphere limit 9/10 (precipobs)</p></li>
<li><p>5     Mean 183 Ghz [ch. 18-22] Tb &lt; 240K</p></li>
<li><p>6     CLW &gt; clw_mwhs2_nrl_UTrej (0.200 kg/m2)</p></li>
<li><p>10    Sea ice &gt; 0.55 detected</p></li>
<li><p>11    Gross error in Tb (any chan.)  (all channels rejected)</p></li>
</ul>
</div></blockquote>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>scatec</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>seaice</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: computed sea-ice fraction from tb23 &amp; tb50</p></li>
<li><p><strong>grossrej</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: .true. if any channel had a gross error from mwbg_grossValueCheck</p></li>
<li><p><strong>waterobs</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: if obs over open-water</p></li>
<li><p><strong>useunbiasedobsforclw</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: use unbiased Tb for CLW calculation</p></li>
<li><p><strong>iwvreject</strong><em> [</em><em>logical </em><em>,</em><em>out</em><em>]</em> :: .true. if Mean 183 Ghz [ch. 18-22] Tb &lt; 240K (too dry for ch.20-22 over land)</p></li>
<li><p><strong>cloudobs</strong><em> [</em><em>logical </em><em>,</em><em>out</em><em>]</em> :: .true. if CLW &gt; clw_atms_nrl_LTrej (0.175) or precipobs</p></li>
<li><p><strong>precipobs</strong><em> [</em><em>logical </em><em>,</em><em>out</em><em>]</em> :: .true. if precip. detected through NRL scattering indices</p></li>
<li><p><strong>cldcnt</strong><em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: Number of water point covered by cloud</p></li>
<li><p><strong>riwv</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: Mean 183 Ghz [ch. 18-22] Tb</p></li>
<li><p><strong>zdi</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: simple AMSU-B Dryness Index Tb(ch.3)-Tb(ch.5)</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckmwhs2" title="f/bgckmicrowave_mod/mwbg_tovcheckmwhs2"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckmwhs2()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_r" title="f/obsspacedata_mod/obs_headelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headset_i" title="f/obsspacedata_mod/obs_headset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headset_i()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/mwbg_reviewallcritforfinalflagsatms">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">mwbg_reviewallcritforfinalflagsatms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">qcrejectlogic</span></em>, <em class="sig-param"><span class="pre">grossrej</span></em>, <em class="sig-param"><span class="pre">waterobs</span></em>, <em class="sig-param"><span class="pre">precipobs</span></em>, <em class="sig-param"><span class="pre">scatec</span></em>, <em class="sig-param"><span class="pre">scatbg</span></em>, <em class="sig-param"><span class="pre">iwvreject</span></em>, <em class="sig-param"><span class="pre">riwv</span></em>, <em class="sig-param"><span class="pre">zdi</span></em>, <em class="sig-param"><span class="pre">drycnt</span></em>, <em class="sig-param"><span class="pre">landcnt</span></em>, <em class="sig-param"><span class="pre">rejcnt</span></em>, <em class="sig-param"><span class="pre">iwvcnt</span></em>, <em class="sig-param"><span class="pre">pcpcnt</span></em>, <em class="sig-param"><span class="pre">flgcnt</span></em>, <em class="sig-param"><span class="pre">chanignoreinallskygencoeff</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/mwbg_reviewallcritforfinalflagsatms" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>Review all the checks previously made to determine which obs are to be accepted
for assimilation and which are to be flagged for exclusion (lflagchn).</p>
<blockquote>
<div><ul class="simple">
<li><p>&lt;grossrej&gt;  = .true. if any channel had a gross error at the point</p></li>
<li><p>&lt;cloudobs&gt;  = .true. if CLW &gt; clw_atms_nrl_LTrej (0.175) or precipobs</p></li>
<li><p>&lt;precipobs&gt; = .true. if precip. detected through NRL scattering indices</p></li>
<li><p>&lt;waterobs&gt;  = .true. if open water point</p></li>
<li><p>&lt;iwvreject&gt; = .true. if Mean 183 Ghz [ch. 18-22] Tb &lt; 240K (too dry for ch.20-22 over land)</p></li>
</ul>
</div></blockquote>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>qcrejectlogic</strong> (*)<em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: .true. if channel is rejected</p></li>
<li><p><strong>grossrej</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: .true. if any channel had a gross error from mwbg_grossValueCheck</p></li>
<li><p><strong>waterobs</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: if obs over open-water</p></li>
<li><p><strong>precipobs</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: .true. if precip. detected through NRL scattering indices</p></li>
<li><p><strong>scatec</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: ECMWF scattering index from tb89 &amp; tb165</p></li>
<li><p><strong>scatbg</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>iwvreject</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: .true. if Mean 183 Ghz [ch. 18-22] Tb &lt; 240K (too dry for ch.20-22 over land)</p></li>
<li><p><strong>riwv</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: Mean 183 Ghz [ch. 18-22] Tb</p></li>
<li><p><strong>zdi</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: simple AMSU-B Dryness Index Tb(ch.3)-Tb(ch.5)</p></li>
<li><p><strong>drycnt</strong><em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: Number of pts flagged for AMSU-B Dryness Index</p></li>
<li><p><strong>landcnt</strong><em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: Number of obs pts found over land/ice</p></li>
<li><p><strong>rejcnt</strong><em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: Number of rejected obs (Tb err, QCfail)</p></li>
<li><p><strong>iwvcnt</strong><em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: Number of pts with Mean 183 Ghz Tb &lt; 240K</p></li>
<li><p><strong>pcpcnt</strong><em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: Number of scatter/precip obs</p></li>
<li><p><strong>flgcnt</strong><em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: Total number of filtered obs</p></li>
<li><p><strong>chanignoreinallskygencoeff</strong> (*)<em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: Channels excluded from gen_bias_corr in all-sky mode</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckatms" title="f/bgckmicrowave_mod/mwbg_tovcheckatms"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckatms()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_r" title="f/obsspacedata_mod/obs_headelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headset_i" title="f/obsspacedata_mod/obs_headset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headset_i()</span></code></a>, <a class="reference internal" href="tovsnl_mod.html#f/tovsnl_mod/tvs_isinstrumallskyhuassim" title="f/tovsnl_mod/tvs_isinstrumallskyhuassim"><code class="xref f f-func docutils literal notranslate"><span class="pre">tvs_isinstrumallskyhuassim()</span></code></a>, <a class="reference internal" href="tovsnl_mod.html#f/tovsnl_mod/tvs_getinstrumentid" title="f/tovsnl_mod/tvs_getinstrumentid"><code class="xref f f-func docutils literal notranslate"><span class="pre">tvs_getinstrumentid()</span></code></a>, <a class="reference internal" href="codtyp_mod.html#f/codtyp_mod/codtyp_get_name" title="f/codtyp_mod/codtyp_get_name"><code class="xref f f-func docutils literal notranslate"><span class="pre">codtyp_get_name()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/mwbg_reviewallcritforfinalflagsmwhs2">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">mwbg_reviewallcritforfinalflagsmwhs2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">qcrejectlogic</span></em>, <em class="sig-param"><span class="pre">grossrej</span></em>, <em class="sig-param"><span class="pre">calcterraintypeindice</span></em>, <em class="sig-param"><span class="pre">waterobs</span></em>, <em class="sig-param"><span class="pre">precipobs</span></em>, <em class="sig-param"><span class="pre">scatec</span></em>, <em class="sig-param"><span class="pre">scatbg</span></em>, <em class="sig-param"><span class="pre">iwvreject</span></em>, <em class="sig-param"><span class="pre">riwv</span></em>, <em class="sig-param"><span class="pre">zdi</span></em>, <em class="sig-param"><span class="pre">allcnt</span></em>, <em class="sig-param"><span class="pre">drycnt</span></em>, <em class="sig-param"><span class="pre">landcnt</span></em>, <em class="sig-param"><span class="pre">rejcnt</span></em>, <em class="sig-param"><span class="pre">iwvcnt</span></em>, <em class="sig-param"><span class="pre">pcpcnt</span></em>, <em class="sig-param"><span class="pre">flgcnt</span></em>, <em class="sig-param"><span class="pre">chanignoreinallskygencoeff</span></em>, <em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/mwbg_reviewallcritforfinalflagsmwhs2" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>Review all the checks previously made to determine which obs are to be accepted
for assimilation and which are to be flagged for exclusion (lflagchn).</p>
<blockquote>
<div><ul class="simple">
<li><p>&lt;grossrej&gt;  = .true. if any channel had a gross error at the point</p></li>
<li><p>&lt;cloudobs&gt;  = .true. if CLW &gt; clw_mwhs2_nrl_LTrej (0.175) or precipobs</p></li>
<li><p>&lt;precipobs&gt; = .true. if precip. detected through NRL scattering indices</p></li>
<li><p>&lt;waterobs&gt;  = .true. if open water point</p></li>
<li><p>&lt;iwvreject&gt; = .true. if Mean 183 Ghz [ch. 18-22] Tb &lt; 240K (too dry for ch.20-22 over land)</p></li>
</ul>
</div></blockquote>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>qcrejectlogic</strong> (*)<em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: .true. if channel is rejected</p></li>
<li><p><strong>grossrej</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: .true. if any channel had a gross error from mwbg_grossValueCheck</p></li>
<li><p><strong>calcterraintypeindice</strong><em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: terrain type (0=ice, -1 otherwise)</p></li>
<li><p><strong>waterobs</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: if obs over open-water</p></li>
<li><p><strong>precipobs</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: .true. if precip. detected through NRL scattering indices</p></li>
<li><p><strong>scatec</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>scatbg</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: Bennartz-Grody scattering index from tb89 &amp; tb165</p></li>
<li><p><strong>iwvreject</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: .true. if Mean 183 Ghz [ch. 18-22] Tb &lt; 240K (too dry for ch.20-22 over land)</p></li>
<li><p><strong>riwv</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: Mean 183 Ghz [ch. 18-22] Tb</p></li>
<li><p><strong>zdi</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: simple AMSU-B Dryness Index Tb(ch.3)-Tb(ch.5)</p></li>
<li><p><strong>allcnt</strong><em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: total number of obs</p></li>
<li><p><strong>drycnt</strong><em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: Number of pts flagged for AMSU-B Dryness Index</p></li>
<li><p><strong>landcnt</strong><em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: Number of obs pts found over land/ice</p></li>
<li><p><strong>rejcnt</strong><em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: Number of rejected obs (Tb err, QCfail)</p></li>
<li><p><strong>iwvcnt</strong><em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: Number of pts with Mean 183 Ghz Tb &lt; 240K</p></li>
<li><p><strong>pcpcnt</strong><em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: Number of scatter/precip obs</p></li>
<li><p><strong>flgcnt</strong><em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: Total number of filtered obs</p></li>
<li><p><strong>chanignoreinallskygencoeff</strong> (*)<em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: Channels excluded from gen_bias_corr in all-sky mode</p></li>
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: numero de satellite (i.e. indice)</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckmwhs2" title="f/bgckmicrowave_mod/mwbg_tovcheckmwhs2"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckmwhs2()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_r" title="f/obsspacedata_mod/obs_headelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_r" title="f/obsspacedata_mod/obs_bodyelem_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_r()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyelem_i" title="f/obsspacedata_mod/obs_bodyelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyelem_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_bodyset_i" title="f/obsspacedata_mod/obs_bodyset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_bodyset_i()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headset_i" title="f/obsspacedata_mod/obs_headset_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headset_i()</span></code></a>, <a class="reference internal" href="tovsnl_mod.html#f/tovsnl_mod/tvs_isinstrumallskyhuassim" title="f/tovsnl_mod/tvs_isinstrumallskyhuassim"><code class="xref f f-func docutils literal notranslate"><span class="pre">tvs_isinstrumallskyhuassim()</span></code></a>, <a class="reference internal" href="tovsnl_mod.html#f/tovsnl_mod/tvs_getinstrumentid" title="f/tovsnl_mod/tvs_getinstrumentid"><code class="xref f f-func docutils literal notranslate"><span class="pre">tvs_getinstrumentid()</span></code></a>, <a class="reference internal" href="codtyp_mod.html#f/codtyp_mod/codtyp_get_name" title="f/codtyp_mod/codtyp_get_name"><code class="xref f f-func docutils literal notranslate"><span class="pre">codtyp_get_name()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/calcstatedepobserr">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">calcstatedepobserr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">cldpredthresh1</span></em>, <em class="sig-param"><span class="pre">cldpredthresh2</span></em>, <em class="sig-param"><span class="pre">errthresh1</span></em>, <em class="sig-param"><span class="pre">errthresh2</span></em>, <em class="sig-param"><span class="pre">cldpredused</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/calcstatedepobserr" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>Calculate single-precision state-dependent observation error.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>cldpredthresh1</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: first cloud predictor threshold</p></li>
<li><p><strong>cldpredthresh2</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: second cloud predictor threshold</p></li>
<li><p><strong>errthresh1</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: sigmaO corresponding to first cloud predictor threshold</p></li>
<li><p><strong>errthresh2</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: sigmaO corresponding to second cloud predictor threshold</p></li>
<li><p><strong>cldpredused</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: cloud predictor for the obs</p></li>
</ul>
</dd>
<dt class="field-odd">Return</dt>
<dd class="field-odd"><p><strong>sigmaobserrused</strong><em> [</em><em>real </em><em>]</em> :: estimated sigmaO for the obs</p>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/bgckmicrowave_mod/amsuatest14roguecheck" title="f/bgckmicrowave_mod/amsuatest14roguecheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsuatest14roguecheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/amsubtest14roguecheck" title="f/bgckmicrowave_mod/amsubtest14roguecheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">amsubtest14roguecheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/atmstest4roguecheck" title="f/bgckmicrowave_mod/atmstest4roguecheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">atmstest4roguecheck()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwhs2test4roguecheck" title="f/bgckmicrowave_mod/mwhs2test4roguecheck"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwhs2test4roguecheck()</span></code></a>, <a class="reference internal" href="obserrors_mod.html#f/obserrors_mod/oer_fillobserrors" title="f/obserrors_mod/oer_fillobserrors"><code class="xref f f-func docutils literal notranslate"><span class="pre">oer_fillobserrors()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/iftovsexist">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">iftovsexist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">headerindex</span></em>, <em class="sig-param"><span class="pre">sensorindex</span></em>, <em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/iftovsexist" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>Check obs is among the sensors.</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>headerindex</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: current header Index</p></li>
<li><p><strong>sensorindex</strong><em> [</em><em>integer </em><em>,</em><em>out</em><em>]</em> :: find tvs_sensor index corresponding to current obs</p></li>
<li><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p></li>
</ul>
</dd>
<dt class="field-odd">Return</dt>
<dd class="field-odd"><p><strong>sensorindexfound</strong><em> [</em><em>logical </em><em>]</em></p>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_bgcheckmw" title="f/bgckmicrowave_mod/mwbg_bgcheckmw"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_bgcheckmw()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="tovsnl_mod.html#f/tovsnl_mod/tvs_mapsat" title="f/tovsnl_mod/tvs_mapsat"><code class="xref f f-func docutils literal notranslate"><span class="pre">tvs_mapsat()</span></code></a>, <a class="reference internal" href="tovsnl_mod.html#f/tovsnl_mod/tvs_mapinstrum" title="f/tovsnl_mod/tvs_mapinstrum"><code class="xref f f-func docutils literal notranslate"><span class="pre">tvs_mapinstrum()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/bgckmicrowave_mod/mwbg_bgcheckmw">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">bgckmicrowave_mod/</span></span><span class="sig-name descname"><span class="pre">mwbg_bgcheckmw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">obsspacedata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/bgckmicrowave_mod/mwbg_bgcheckmw" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose </dt>
<dd class="field-odd"><p>Do the quality control for ATMS, AMSUA, AMSUB and MWHS2</p>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><p><strong>obsspacedata</strong><em> [</em><em>struct_obs </em><em>,</em><em>inout</em><em>]</em> :: obspaceData Object</p>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="../programs/midas_obsSelection.html#f/midas_obsselection" title="f/midas_obsselection"><code class="xref f f-prog docutils literal notranslate"><span class="pre">midas_obsselection</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="utilities_mod.html#f/utilities_mod/utl_tmg_start" title="f/utilities_mod/utl_tmg_start"><code class="xref f f-func docutils literal notranslate"><span class="pre">utl_tmg_start()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_getheaderindex" title="f/obsspacedata_mod/obs_getheaderindex"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_getheaderindex()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_headelem_i" title="f/obsspacedata_mod/obs_headelem_i"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_headelem_i()</span></code></a>, <a class="reference internal" href="tovsnl_mod.html#f/tovsnl_mod/tvs_isidburpinst" title="f/tovsnl_mod/tvs_isidburpinst"><code class="xref f f-func docutils literal notranslate"><span class="pre">tvs_isidburpinst()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_init" title="f/bgckmicrowave_mod/mwbg_init"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_init()</span></code></a>, <a class="reference internal" href="obsspacedata_mod.html#f/obsspacedata_mod/obs_numheader" title="f/obsspacedata_mod/obs_numheader"><code class="xref f f-func docutils literal notranslate"><span class="pre">obs_numheader()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/iftovsexist" title="f/bgckmicrowave_mod/iftovsexist"><code class="xref f f-func docutils literal notranslate"><span class="pre">iftovsexist()</span></code></a>, <a class="reference internal" href="utilities_mod.html#f/utilities_mod/utl_abort" title="f/utilities_mod/utl_abort"><code class="xref f f-func docutils literal notranslate"><span class="pre">utl_abort()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_readgeophysicfieldsandinterpolate" title="f/bgckmicrowave_mod/mwbg_readgeophysicfieldsandinterpolate"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_readgeophysicfieldsandinterpolate()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsua" title="f/bgckmicrowave_mod/mwbg_tovcheckamsua"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsua()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckamsub" title="f/bgckmicrowave_mod/mwbg_tovcheckamsub"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckamsub()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckatms" title="f/bgckmicrowave_mod/mwbg_tovcheckatms"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckatms()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_tovcheckmwhs2" title="f/bgckmicrowave_mod/mwbg_tovcheckmwhs2"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_tovcheckmwhs2()</span></code></a>, <a class="reference internal" href="#f/bgckmicrowave_mod/mwbg_qcstats" title="f/bgckmicrowave_mod/mwbg_qcstats"><code class="xref f f-func docutils literal notranslate"><span class="pre">mwbg_qcstats()</span></code></a>, <a class="reference internal" href="utilities_mod.html#f/utilities_mod/utl_tmg_stop" title="f/utilities_mod/utl_tmg_stop"><code class="xref f f-func docutils literal notranslate"><span class="pre">utl_tmg_stop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="bgckocean_mod.html" title="bgckOcean_mod"
             >next</a> |</li>
        <li class="right" >
          <a href="bgckcsr_mod.html" title="bgckCSR_mod"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">MIDAS  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">bgckMicrowave_mod</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, ECCC.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
    </div>
  </body>
</html>